---
title: Premiers résultats de l’enquête « Les personnels de la recherche face au changement
  climatique »
output:
  html_document:
    fig_width: 7.5
    fig_height: 4.5
    toc: yes
    number_sections: yes
---

```{r preparation, echo=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
load("climat.RData")
source("recodages.R", encoding = "UTF-8")
theme_set(theme_minimal())
update_geom_defaults("bar", list(fill="#045a8d"))
update_geom_defaults("col", list(fill="#045a8d"))
```

# Informations générales

## Statut académique

```{r echo=FALSE}
ggplot(drop_na(climat, statut),
       aes(y=fct_rev(statut), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="")
```

## Situation professionnelle

```{r echo=FALSE}
ggplot(drop_na(climat, sitpro),
       aes(y=fct_rev(sitpro), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="")
```


## Doctorants

Il y a 18% de doctorant.es dans l'échantillon.

## Disciplines et BAP


```{r echo=FALSE}
ggplot(drop_na(climat, discipline_agr),
       aes(y=fct_rev(discipline_agr), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="")
```
```{r echo=FALSE}
ggplot(drop_na(climat, bap),
       aes(y=fct_rev(bap), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="")

```


# Votre position vis-à-vis de l’environnement et de la recherche

## Activités humaines et changement climatique
```{r echo=FALSE}
climat$acthum3 <- fct_collapse(climat$acthum2,
                               "Oui, elles jouent un grand rôle\nou en sont l'unique cause"=c("Oui, elles en sont l'unique cause", 
                                 "Oui, elles jouent un grand rôle"))
pal <- RColorBrewer::brewer.pal(6, "RdYlGn")
ggplot(drop_na(climat, acthum3),
       aes(y=fct_rev(acthum3), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", pal[c(1, 2, 4, 6)])) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 1)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  theme(plot.title=element_text(size=11), plot.subtitle=element_text(size=8)) +
  labs(x="Proportion des répondant·es", y="",
       title="Les activités humaines sont-elles la cause du changement climatique\n(hausse des températures depuis une centaine d'années) ?",
       # subtitle="Pensez-vous que le climat de la planète est en train de changer\n(hausse des températures depuis une centaine d’années) ?\nSi oui : D’après vous, les activités humaines sont-elles la cause de ce changement climatique ?",
       caption="Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : personnels affiliés à une unité du CNRS (n=6339)")

```

## Préoccupation par rapport au changement climatique
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, preoccupe),
       aes(y=fct_relevel(preoccupe, "Sans opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#74add1", "#fee090", "#fdae61", "#f46d43", "#d73027")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.42)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  theme(plot.title=element_text(size=11), plot.subtitle=element_text(size=8)) +
  labs(x="Proportion des répondant·es", y="",
       title="Dans quelle mesure êtes-vous préoccupé·e par le changement climatique ?",
       # subtitle="Pensez-vous que le climat de la planète est en train de changer\n(hausse des températures depuis une centaine d’années) ?\nSi oui : D’après vous, les activités humaines sont-elles la cause de ce changement climatique ?",
       caption="Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : personnels affiliés à une unité du CNRS (n=6344)")

```

# Vos pratiques et celles de votre laboratoire

# Vos transports à des fins professionnelles

## Heures de vol en avion

Pour l'année 2019 (du 1er janvier au 31 décembre), nombre d'heures de vol en avion

```{r echo=FALSE}
climat$volshTot<-climat$volsh
levels(climat$volshTot)<-c("0h", levels(climat$volshTot))
climat$volshTot[climat$volsnb==0]<-"0h"

ggplot(drop_na(climat, volshTot),
       aes(y=fct_rev(volshTot), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="Nombre d'heures de vol en 2019")
```

## Nombre de jours travaillés sur place

Nombre de jours travaillés sur place lors d'un déplacement professionnel en avion

```{r echo=FALSE, message=FALSE}
#En fonction du nombre de déplacements pro
#On tient compte du nombre d'aller retour pour avoir le nombre de séjours réels (volsnb)
#Pour tout demi aller-retour, il faut aussi compter un séjour entier (ceiling)
DFNbJourTravailles<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsjours", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>%
  count(volsjours, wt=ceiling(volsnb)) %>%
  drop_na(volsjours) %>%
  mutate(prop=n/sum(n))

ggplot(DFNbJourTravailles,  aes(x=prop, y=volsjours )) + geom_col() +
  labs(y="", x="",
       title="Part des déplacements professionnels en avion effectués \n par l'ensemble des répondants,\n selon le temps travaillé sur place") 

#En fonction de la distance totale parcourue
DFNbJourTravailles<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsjours", 1:5), paste0("volsdist", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>% group_by(volsjours) %>%
  summarize(DistTotale=sum(volsdist*volsnb, na.rm=T)) %>%
  drop_na(volsjours) %>%
  mutate(prop=DistTotale/sum(DistTotale))

ggplot(DFNbJourTravailles,  aes(x=prop, y=volsjours )) + geom_col() +
  labs(y="", x="",
       title="Part de la distance totale parcourue en avion par l'ensemble\n des répondants, selon le temps travaillé sur place") 



###Attention : par défaut, il faudrait fixer les volnb indiqués NA à la valeur 1 (oubli des gens)


```

## Motif des vols

Motif principal des déplacements professionnels en avion

```{r echo=FALSE, message=FALSE}
#En fonction du nombre de déplacements pro
#On tient compte du nombre d'aller retour pour avoir le nombre de séjours réels (volsnb)
#Pour tout demi aller-retour, il faut aussi compter un séjour entier (ceiling)
DFDistAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsmotif", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>%
  count(volsmotif, wt=ceiling(volsnb)) %>%
  drop_na(volsmotif) %>%
  mutate(prop=n/sum(n))

ggplot(DFDistAvion,  aes(x=prop, y=volsmotif )) + geom_col() +
  labs(y="Motif principal du déplacement en avion", x="% des déplacements effectués en avion par les répondants",
       title="Motif principal pour les déplacements professionnels\n effectués en avion") 

#En fonction de la distance totale parcourue
DFDistAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsmotif", 1:5), paste0("volsdist", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>% group_by(volsmotif) %>%
  summarize(DistTotale=sum(volsdist*volsnb, na.rm=T)) %>%
  drop_na(volsmotif) %>%
  mutate(prop=DistTotale/sum(DistTotale))

ggplot(DFDistAvion,  aes(x=prop, y=fct_reorder(volsmotif, prop) )) + geom_col() +
  labs(y="", x="% des kms parcourus en avion par les répondants",
       title="Part de la distance totale parcourue en avion\n par l'ensemble des répondants, selon le motif principal\n du déplacement professionnel") 

```

## Distance parcourue en avion, par motif

Distance moyenne parcourue en avion par motif principal du déplacement en avion

```{r echo=FALSE, message=FALSE}
DFDistMoyAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsmotif", 1:5), paste0("volsdist", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>% group_by(volsmotif) %>%
  summarize(DistMoy=mean(volsdist, na.rm=T)) %>%
  drop_na(volsmotif)

ggplot(DFDistMoyAvion,  aes(x=DistMoy, y=fct_reorder(volsmotif, DistMoy) )) + geom_col() +
  labs(y="Motif principal du déplacement en avion", x="Distance moyenne parcourue en avion",
       title="Distance moyenne parcourue en avion par motif principal\n du déplacement") 

```


## Part de la distrance totale parcourue en avion correspondant à des trajets en train de moins de 3h
Proportion de la distance totale parcourue en avion par les répondants avec des trajets en train de moins de 3H (estimation)

```{r echo=FALSE, message=FALSE}
DFDistAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsdist", 1:5), paste0("volsh", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) 
#On regarde Volh<2 car c'est le temps pour l'aller retour. On maximise en disant que jusqu'à une heure d'avion, on a un train de moins de 3h
DFDistAvion$VolInf3h <- NA
DFDistAvion$VolInf3h[DFDistAvion$volsh<2]<-"Trajet effectuable en moins de 3h en train"
DFDistAvion$VolInf3h[DFDistAvion$volsh>=2]<-"Trajet effectuable en plus de 3h en train"

DFDistAvion<-DFDistAvion%>% group_by(VolInf3h) %>%
  summarize(DistTotale=sum(volsdist*volsnb, na.rm=T)) %>%
  drop_na(VolInf3h) %>%
  mutate(prop=DistTotale/sum(DistTotale))

ggplot(DFDistAvion,  aes(x=prop, y=fct_reorder(VolInf3h, prop) )) + geom_col() +
  labs(y="", x="",
       title="Part estimée de la distance totale parcourue en avion\n par l'ensemble des répondants, selon la durée du trajet\n en train correspondant") 

```

## Prendre l'avion alors que le trajet en train fait moins de 6H
Pour ceux qui ont pris l'avion en 2019 : En 2019, avez-vous pris l’avion pour un trajet professionnel qui prend moins de 6 heures en train (hors déplacements domicile-travail) ?

```{r echo=FALSE}
ggplot(drop_na(climat, aviontrain),
       aes(y=fct_rev(aviontrain), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  labs(x="Proportion des répondant·es ayant pris l'avion en 2019", y="", 
       title ="En 2019, avez-vous pris l’avion pour un trajet professionnel qui prend moins\n de 6 heures en train (hors déplacements domicile-travail) ?")
```

## Raisons de prendre l'avion alors que le trajet en train fait moins de 6H

## Prendre le train plutot que l'avion alors que le trajet est plus long
Au cours des 5 dernières années, avez-vous, pour des raisons environnementales, pris le train plutôt que l’avion dans le cadre professionnel alors que le trajet était plus long ?

```{r echo=FALSE}
ggplot(drop_na(climat, trainavion),
       aes(y=fct_rev(trainavion), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  labs(x="", y="", 
       title ="Au cours des 5 dernières années, avez-vous, pour des raisons\n environnementales, pris le train plutôt que l’avion\n dans le cadre professionnel alors que le trajet était plus long ?")
```

## Renoncé à un déplacement à l'étranger pour des raisons environnementales
En 2019, avez-vous renoncé à un ou plusieurs déplacements professionnels à l’étranger (y compris décidé de ne pas candidater à une conférence) pour des considérations environnementales ?

```{r echo=FALSE}
ggplot(drop_na(climat, renoncedep.env),
       aes(y=fct_rev(renoncedep.env), x=..prop.., group=1)) +
  geom_bar(fill="white", color="chartreuse3") +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="", y="")
```

## Travail à domicile
En temps normal (avant le confinement), combien de jours en moyenne travaillez-vous uniquement de chez vous ? Ne tenez pas compte des éventuels jours travaillés le week-end.


```{r echo=FALSE}
ggplot(drop_na(climat, joursdomicile),
       aes(y=fct_rev(joursdomicile), x=..prop.., group=1)) +
  geom_bar(fill="white", color="chartreuse3") +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="", y="")
```

## Déplacements domicile travail
Avant le confinement, combien de temps passiez-vous en moyenne par semaine dans les  transports suivants pour vos déplacements domicile-travail ? Indiquez la somme de tous les trajets pour aller et revenir du travail, y compris les trajets longue distance. Laissez vides les cases qui ne vous concernent pas ou qui seraient à 0.


```{r echo=FALSE}
TpsTransportDomT<- climat %>% 
  select(tpsdomtrav.urbainMin, tpsdomtrav.tgvMin, tpsdomtrav.trainMin, tpsdomtrav.voitMin, tpsdomtrav.covoitMin, tpsdomtrav.motoMin, tpsdomtrav.veloMin, tpsdomtrav.marcheMin ) %>%
  pivot_longer(everything(),
               names_to = c(".value", "TypeTransport"),
               names_sep = 11) %>% group_by(TypeTransport) %>%
  summarize(Tpstotal=sum(tpsdomtrav., na.rm=T)) %>%
   mutate(prop=Tpstotal/sum(Tpstotal))


ggplot(TpsTransportDomT,  aes(x=prop, y=fct_reorder(TypeTransport, prop) )) + geom_col() +
  labs(y="", x="",
       title="Part du temps total passé dans les déplacements domicile travail,\n par mode de transport") 
```


# La visioconférence

# Votre avis personnel par rapport à l’écologie en général

## Opinions sur l'écologie

```{r echo=FALSE}
dat <- rbind(data.frame(variable="La plupart des problèmes environnementaux peuvent être résolus\npar le développement de technologies plus performantes",
                        valeur=climat$opinionecolo.techno),
             data.frame(variable="La décroissance est nécessaire\npour faire face aux enjeux environnementaux", valeur=climat$opinionecolo.decroissance),
             data.frame(variable="Protéger l’environnement est plus important\nque protéger la croissance économique", valeur=climat$opinionecolo.proteger),
             data.frame(variable="Ce type de catastrophe pourrait provoquer\nun effondrement de nos sociétés*", valeur=climat$opinionecolo.effondrement2),
             data.frame(variable="Si les choses continuent au rythme actuel,\nnous allons bientôt vivre une catastrophe écologique majeure", valeur=climat$opinionecolo.cata)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("Tout à fait d'accord", "Plutôt d'accord", "Sans opinion", "Plutôt pas d'accord", "Pas du tout d'accord")))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "#fdae61", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom", plot.title=element_text(size=11)) +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion des répondant·es", x="",
         caption="* Les personnes ayant répondu négativement à la question précédente sont classés en « Pas du tout d'accord ».")
```

# Les solutions concrètes dans la recherche

## Réduction des émissions de la recherche d'ici à 2030
La France s’est engagée à réduire d’un tiers ses émissions de gaz à effet de serre d’ici à 2030. Dans ce cadre, pensez-vous que :

- La recherche publique doit montrer l’exemple en matière de diminution des émissions de gaz à effet de serre en les réduisant de plus d’un tiers
- La recherche publique doit réduire ses émissions de gaz à effet de serre d’un tiers environ
- En raison de son rôle, la recherche publique peut bénéficier d’un statut dérogatoire, c’est-à-dire fournir des efforts moindres en termes de réduction des émissions de gaz à effet de serre

```{r echo=FALSE}
climat$solreducrech2 <- fct_recode(climat$solreducrech,
  "De plus d'un tiers" = "La recherche publique doit montrer l'exemple en matière de diminution des émissions de gaz à effet de serre en les rédui",
  "D'un tiers environ" = "La recherche publique doit réduire ses émissions de gaz à effet de serre d'un tiers environ",
  "De moins d'un tiers" = "En raison de son rôle, la recherche publique peut bénéficier d'un statut dérogatoire, c'est-à-dire fournir des efforts m"
)
ggplot(drop_na(climat, solreducrech2),
       aes(y=fct_rev(solreducrech2), x=..prop.., group=1)) +
    geom_bar() +
    scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
    coord_cartesian(xlim=c(0, 0.5)) +
    geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
    labs(x="Proportion des répondant·es", y="",
         title="D'ici 2030, la recherche publique doit réduire ses émissions...")
```

# Solutions institutionnelles

Quelles actions les institutions et laboratoires de recherche devraient-ils mettre en œuvre pour réduire leurs émissions de gaz à effet de serre ?

```{r echo=FALSE}
dat <- rbind(data.frame(variable="Ajouter les émissions carbone parmi les principaux\ncritères de sélection des projets à financer", valeur=climat$solinstit.selection),
             data.frame(variable="Imposer une limite au nombre de vols\nen avion par personne", valeur=climat$solinstit.limitevols),
             data.frame(variable="Proscrire les vols en avion lorsque\nle trajet en train prend moins de 6 heures", valeur=climat$solinstit.vols6h),
             data.frame(variable="Dresser et diffuser régulièrement\ndes bilans carbone détaillés", valeur=climat$solinstit.bilanges)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("C'est prioritaire", "C'est secondaire", "Sans opinion", "Il ne faut pas le mettre en œuvre")))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom", plot.title=element_text(size=11)) +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion des répondant·es", x="",
         title="Actions à mettre en œuvre\npour réduire les émissions carbone :")
```


# Informations concernant votre activité et votre situation personnelle

# Quiz sur les émissions de gaz à effet de serre