---
title: "S1 Appendix. Additional tables and plots"
output:
  html_document: 
    fig_width: 7.5
    fig_height: 4.5
    dev: svg
    fontsize: 12pt
    highlight: haddock
    number_sections: yes
    theme: united
    toc: yes
    toc_float: yes
---

```{r preparation, message=FALSE, include=FALSE}
library(tidyverse)
library(ggplot2)
library(questionr)
library(paletteer)
library(gtsummary)


load("climat.RData")
source("recodages.R", encoding = "UTF-8")

theme_set(theme_minimal() +
          theme(plot.title=element_text(size=11),
                  plot.caption=element_text(lineheight=1.1)))
update_geom_defaults("bar", list(fill="#045a8d"))
update_geom_defaults("col", list(fill="#045a8d"))

texte_legende <- "Source: “Research personnel and climate change” survey, Labos 1point5, 2020\nCoverage: personnel affiliated with a CNRS unit"
source_champ <- function(n=NA, extra=NA) {
  if(is.na(n))
    texte <- texte_legende
  else
    texte <- paste0(texte_legende, " (n=", n, ")")

  if(is.na(extra))
    labs(caption=texte)
  else
    labs(caption=paste(extra, texte, sep="\n"))
}

table_multi <- function(dat, levs=levels(dat$valeur)) {
    dat$valeur <- fct_relevel(dat$valeur, levs)
    res <- group_by(dat, variable) %>% drop_na() %>% count(valeur) %>% transmute(valeur, pourcent=round(n/sum(n)*100)) %>% pivot_wider(names_from=valeur, values_from=pourcent)
    mat <- as.matrix(res[,-1])
    mat <- cbind(mat, Total=100)
    rownames(mat) <- sub("\n", " ", res[[1]])
    # Inverser l'ordre des lignes par cohérence avec ggplot
    mat[nrow(mat):1,]
}

climat$sitpro_reduite <- fct_recode(climat$sitpro,
  "Doctorant·e contractuel·le" = "Doctorant·e CIFRE")
climatRegr$sitpro_reduite <- fct_recode(climatRegr$sitpro,
  "Doctorant·e contractuel·le" = "Doctorant·e CIFRE")

climat$solreducrech3 <- fct_recode(climat$solreducrech,
  "Plus d'un tiers" = "La recherche publique doit montrer l'exemple en matière de diminution des émissions de gaz à effet de serre en les rédui",
  "Un tiers environ" = "La recherche publique doit réduire ses émissions de gaz à effet de serre d'un tiers environ",
  "Moins d'un tiers" = "En raison de son rôle, la recherche publique peut bénéficier d'un statut dérogatoire, c'est-à-dire fournir des efforts m"
)

Sys.setlocale("LC_ALL", "en_US.UTF-8")
Sys.setlocale("LC_MESSAGES", "en_US.UTF-8")

climat$sexe <- fct_recode(factor(climat$sexe), "Man"= "Homme", "Woman"="Femme", "Other"= "Autre") 

climat$ageAgr <- fct_recode(factor(climat$ageAgr), "Under 29 years old"= "Moins de 29 ans", "30-34 years old"= "30-34 ans","35-39 years old"="35-39 ans", "40-44 years old"= "40-44 ans", "45-49 years old"="45-49 ans", "50-54 years old"= "50-54 ans", "55-64 years old"="55-64 ans", "65 years and older"= "65 ans et plus")

climat$sitpro_reduite <- fct_recode(climat$sitpro_reduite, "Senior researcher"="Directeur·rice de recherche", "Full professor"="Professeur·e des universités", "Tenured researcher"="Chargé·e de recherche", "Associate professor"="Maître·sse de conférences", "Postdoctoral researcher"="Post-doctorant·e", "Adjunct lecturer"="ATER", "Fully funded PhD student"="Doctorant·e contractuel·le", "Research engineer"="Ingénieur·e de recherche", "Research support engineer"="Ingénieur·e d'études", "Engineer assistant"="Assistant ingénieur·e", "Technician"="Technicien·ne", "Research assistant/Project manager"="Chargé·e d'études/de mission", "Technical assistant"="Adjoint·e technique", "Other personnel"="Autre")

climat$discipline_agr4 <- fct_recode(factor(climat$discipline_agr4),"Physics"="Physique", "Law, economics, management"="Droit, économie, gestion", "Other humanities and social sciences"= "Autres lettres et sciences humaines", "History, geography, urbanism, anthropology"= "Histoire, géo, urba, anthropo","Mathematics"="Mathématiques", "Computer science"="Informatique", "Chemistry"="Chimie","Astronomy"="Astronomie","Geology"="Géologie", "Meteorology, oceanology, environmental physics"= "Météo, océano, physique environt", "Health and medical research"="Santé et recherche médicale", "Engineering"= "Ingénierie","Biology"="Biologie","Population biology and ecology"="Biologie des populations et écologie")


climat$changclim <- fct_recode(factor(climat$changclim), "Yes, definitely"="Oui, certainement", "Yes, probably"="Oui, probablement", "No, probably not"="Non, probablement pas", "No, definitely not"="Non, certainement pas", "No opinion"="Sans opinion")

climat$acthum <- fct_recode(factor(climat$acthum), "Yes, they are the only cause"="Oui, elles en sont l'unique cause", "Yes, they play a major role"="Oui, elles jouent un grand rôle", "Yes, they play a small role"="Oui, elles jouent un petit rôle", "No, they play no role"="Non, elles ne jouent aucun rôle", "No opinion"="Sans opinion")

climat$acthum2 <- fct_recode(factor(climat$acthum2), "Yes, they are the only cause"="Oui, elles en sont l'unique cause", "Yes, they play a major role"="Oui, elles jouent un grand rôle", "Yes, they play a small role"="Oui, elles jouent un petit rôle", "No, they play no role"="Non, elles ne jouent aucun rôle", "Climate change does not exist"="Il n'y a pas de changement climatique", "No opinion"="Sans opinion")

climat$acthum3 <- fct_collapse(climat$acthum2,
                               "Yes, they play a major role\nor are the only cause"=c("Yes, they are the only cause", 
                                 "Yes, they play a major role"))

climat$preoccupe <- fct_recode(factor(climat$preoccupe), "Not at all concerned"="Pas du tout préoccupé·e","Slightly concerned"="Un peu préoccupé·e","Somewhat concerned"="Assez préoccupé·e", "Very concerned"="Très préoccupé·e", "Extremely concerned"="Extrêmement préoccupé·e","No opinion"="Sans opinion")

climat$preoccupe2 <- fct_recode(factor(climat$preoccupe2), "Not at all concerned"="Pas du tout préoccupé·e","Slightly concerned"="Un peu préoccupé·e","Somewhat concerned"="Assez préoccupé·e", "Very concerned"="Très préoccupé·e", "Extremely concerned"="Extrêmement préoccupé·e","No opinion"="Sans opinion")

climat$pluspreoccupe <- fct_recode(factor(climat$pluspreoccupe), "Much more"="Beaucoup plus", "Somewhat more"="Un peu plus", "Neither more nor less"="Ni plus ni moins", "Somewhat less"="Un peu moins", "Much less"="Beaucoup moins", "No opinion"="Sans opinion")

climat$chgtpratique <- fct_recode(factor(climat$chgtpratique), "Yes, strongly agree"="Oui, tout à fait d'accord", "Yes, somewhat agree"="Oui, plutôt d'accord", "No, somewhat disagree"="Non, plutôt pas d'accord", "No, strongly disagree"="Non, pas du tout d'accord", "No opinion"="Sans opinion")

climat$solreducrech <- fct_recode(factor(climat$solreducrech), "Set an example (reduce emissions by more than one-third)"= "La recherche publique doit montrer l'exemple en matière de diminution des émissions de gaz à effet de serre en les rédui","Reduce emissions by around one-third"="La recherche publique doit réduire ses émissions de gaz à effet de serre d'un tiers environ", "Benefit from an exemption (reduce emissions by less than one-third)"= "En raison de son rôle, la recherche publique peut bénéficier d'un statut dérogatoire, c'est-à-dire fournir des efforts m")

climat$solreducrech3 <- fct_recode(factor(climat$solreducrech), "More than one-third"="Set an example (reduce emissions by more than one-third)", "Around one-third"="Reduce emissions by around one-third", "Less than one-third"="Benefit from an exemption (reduce emissions by less than one-third)")

climat$opinionecolo.cata <- fct_recode(factor(climat$opinionecolo.cata), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$opinionecolo.contraintes <- fct_recode(factor(climat$opinionecolo.contraintes), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$opinionecolo.proteger<- fct_recode(factor(climat$opinionecolo.proteger), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$opinionecolo.efforts<- fct_recode(factor(climat$opinionecolo.efforts), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$opinionecolo.techno<- fct_recode(factor(climat$opinionecolo.techno), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$opinionecolo.decroissance<- fct_recode(factor(climat$opinionecolo.decroissance), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$opinionecolo.effondrement2<- fct_recode(factor(climat$opinionecolo.effondrement2), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climat$solinstit.limitevols<- fct_recode(factor(climat$solinstit.limitevols), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.selection<- fct_recode(factor(climat$solinstit.selection), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.conf<- fct_recode(factor(climat$solinstit.conf), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.bilanges<- fct_recode(factor(climat$solinstit.bilanges), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.train<- fct_recode(factor(climat$solinstit.train), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.compensation<- fct_recode(factor(climat$solinstit.compensation), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.vols6h<- fct_recode(factor(climat$solinstit.vols6h), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.info<- fct_recode(factor(climat$solinstit.info), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.equip<- fct_recode(factor(climat$solinstit.equip), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$solinstit.vege<- fct_recode(factor(climat$solinstit.vege), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climat$carriere<- fct_recode(factor(climat$carriere), "Yes"="Oui", "No"="Non")

climat$malpaye<- fct_recode(factor(climat$malpaye), "Yes"="Oui", "No"="Non")

climat$international.naiss<- fct_recode(factor(climat$international.naiss), "Yes"="Oui", "No"="Non")

climat$reliquat.ordi <- fct_recode(factor(climat$reliquat.ordi), "Yes"="Oui", "No"="Non", "I have not had leftover budget money to spend"="Je n'ai pas eu à utiliser de reliquat de budget")

climat$reliquat.avion <- fct_recode(factor(climat$reliquat.avion), "Yes"="Oui", "No"="Non", "I have not had leftover budget money to spend"="Je n'ai pas eu à utiliser de reliquat de budget")

climat$solreducperso.conf <- fct_recode(factor(climat$solreducperso.conf), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducperso.donnees <- fct_recode(factor(climat$solreducperso.donnees), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducperso.exp <- fct_recode(factor(climat$solreducperso.exp), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducperso.info <- fct_recode(factor(climat$solreducperso.info), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducperso.domicile <- fct_recode(factor(climat$solreducperso.domicile), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducmateriel.util <- fct_recode(factor(climat$solreducmateriel.util), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducmateriel.lowtech <- fct_recode(factor(climat$solreducmateriel.lowtech), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducmateriel.moins <- fct_recode(factor(climat$solreducmateriel.moins), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solreducmateriel.renouv <- fct_recode(factor(climat$solreducmateriel.renouv), "Yes, by at least one-third"="Oui, d'au moins un tiers", "Yes, but by less than one-third"="Oui, mais de moins d'un tiers", "No, as they are already very low"="Non, car elles sont déjà très basses", "No"="Non", "Not concerned"="Non concerné·e", "No opinion"="Sans opinion")

climat$solrisqreducavion.qual <- fct_recode(factor(climat$solrisqreducavion.qual), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.fin <- fct_recode(factor(climat$solrisqreducavion.fin), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.diffusion <- fct_recode(factor(climat$solrisqreducavion.diffusion), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.donnees <- fct_recode(factor(climat$solrisqreducavion.donnees), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.avantages <- fct_recode(factor(climat$solrisqreducavion.avantages), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.isoler <- fct_recode(factor(climat$solrisqreducavion.isoler), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.insertion <- fct_recode(factor(climat$solrisqreducavion.insertion), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducavion.bureaucratie <- fct_recode(factor(climat$solrisqreducavion.bureaucratie), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducmateriel.qual <- fct_recode(factor(climat$solrisqreducmateriel.qual), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducmateriel.themes <- fct_recode(factor(climat$solrisqreducmateriel.themes), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducmateriel.fin <- fct_recode(factor(climat$solrisqreducmateriel.fin), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducmateriel.retard <- fct_recode(factor(climat$solrisqreducmateriel.retard), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$solrisqreducmateriel.publi <- fct_recode(factor(climat$solrisqreducmateriel.publi), "It is likely and it is a problem"="C'est probable et c'est un problème", "It is likely but it is not a problem"="C'est probable mais ce n'est pas un problème", "It is unlikely"="C'est peu probable", "No opinion"="Sans opinion", "Not concerned"="Non concerné·e")

climat$NumVague <- fct_recode(factor(climat$NumVague), "After the first message"="Après premier message", "After the first reminder"="Après première relance", "After the second reminder"="Après deuxième relance", "After the third reminder"="Après troisième relance", "After the fourth reminder"="Après quatrième relance")



climatRegr$sexe <- fct_recode(factor(climatRegr$sexe), "Man"= "Homme", "Woman"="Femme", "Other"= "Autre") 

climatRegr$ageAgr <- fct_recode(factor(climatRegr$ageAgr), "Under 29 years old"= "Moins de 29 ans", "30-34 years old"= "30-34 ans","35-39 years old"="35-39 ans", "40-44 years old"= "40-44 ans", "45-49 years old"="45-49 ans", "50-54 years old"= "50-54 ans", "55-64 years old"="55-64 ans", "65 years and older"= "65 ans et plus")

climatRegr$sitpro_reduite <- fct_recode(factor(climatRegr$sitpro_reduite), "Senior researcher"="Directeur·rice de recherche", "Full professor"="Professeur·e des universités", "Tenured researcher"="Chargé·e de recherche", "Associate Professor"="Maître·sse de conférences", "Postdoctoral researcher"="Post-doctorant·e", "Adjunct lecturer"= "ATER", "Fully funded PhD student"="Doctorant·e contractuel·le", "Research engineer"="Ingénieur·e de recherche", "Research support engineer"="Ingénieur·e d'études", "Engineer assistant"="Assistant ingénieur·e", "Technician"="Technicien·ne", "Research assistant/Project manager"="Chargé·e d'études/de mission", "Technical assistant"="Adjoint·e technique", "Other personnel"="Autre")
climatRegr$sitpro_reduite2 <- relevel(climatRegr$sitpro_reduite, ref = "Associate Professor")


climatRegr$discipline_agr4 <- fct_recode(factor(climatRegr$discipline_agr4),"Physics"="Physique", "Law, economics, management"="Droit, économie, gestion", "Other humanities and social sciences"= "Autres lettres et sciences humaines", "History, geography, urbanism, anthropology"= "Histoire, géo, urba, anthropo","Mathematics"="Mathématiques", "Computer science"="Informatique", "Chemistry"="Chimie","Astronomy"="Astronomie","Geology"="Géologie", "Meteorology, oceanology, environmental physics"= "Météo, océano, physique environt", "Health and medical research"="Santé et recherche médicale", "Engineering"= "Ingénierie","Biology"="Biologie","Population biology and ecology"="Biologie des populations et écologie")

climatRegr$preoccupe2 <- fct_recode(factor(climatRegr$preoccupe2), "Not at all concerned"="Pas du tout préoccupé·e","Slightly concerned"="Un peu préoccupé·e","Somewhat concerned"="Assez préoccupé·e", "Very concerned"="Très préoccupé·e", "Extremely concerned"="Extrêmement préoccupé·e","No opinion"="Sans opinion")

climatRegr$solreducrech2 <- fct_recode(factor(climatRegr$solreducrech2), "Set an example (reduce emissions by more than one-third)"= "Recherche doit montrer l'exemple, réduire de plus d'1/3","Reduce emissions by around one-third"="Recherche doit réduire émissions de GES de 1/3 environ", "Benefit from an exemption (reduce emissions by less than one-third)"= "Recherche peut bénéficier d'un statut dérogatoire")

climatRegr$opinionecolo.cata <- fct_recode(factor(climatRegr$opinionecolo.cata), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climatRegr$opinionecolo.contraintes <- fct_recode(factor(climatRegr$opinionecolo.contraintes), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climatRegr$opinionecolo.proteger<- fct_recode(factor(climatRegr$opinionecolo.proteger), "Completely agree"="Tout à fait d'accord", "Somewhat agree"="Plutôt d'accord", "Somewhat disagree"="Plutôt pas d'accord", "Completely disagree"="Pas du tout d'accord", "No opinion"="Sans opinion")

climatRegr$solinstit.limitevols<- fct_recode(factor(climatRegr$solinstit.limitevols), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climatRegr$solinstit.selection<- fct_recode(factor(climatRegr$solinstit.selection), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climatRegr$solinstit.conf<- fct_recode(factor(climatRegr$solinstit.conf), "It is a priority"="C'est prioritaire", "It is secondary"="C'est secondaire","It should not be implemented"= "Il ne faut pas le mettre en œuvre", "No opinion"="Sans opinion")

climatRegr$carriere<- fct_recode(factor(climatRegr$carriere), "Yes"="Oui", "No"="Non")

climatRegr$malpaye<- fct_recode(factor(climatRegr$malpaye), "Yes"="Oui", "No"="Non")

climatRegr$international.naiss<- fct_recode(factor(climatRegr$international.naiss), "Yes"="Oui", "No"="Non")
```

# Sample and non-response bias

## Response rate by status and discipline
```{r echo=FALSE}
repstatut <- c(`Senior researcher` = 0.298029556650246, `Full professor` = 0.187197618161518, `Tenured researcher` = 0.357738646895273, `Associate professor` = 0.242277140335393, `Research engineer` = 0.335389360061681, `Postdoctoral researcher` = 0.175438596491228, `Fully funded PhD student` = 0.170106132075472, `Research support engineer` = 0.298368298368298, `Engineer assistant` = 0.247533632286996, `Technician` = 0.15253386853989, `Temp on fixed-term contract` = 0.212272727272727, `Other personnel` = 0.171935235158057)

data.frame(statut=factor(names(repstatut), levels=rev(names(repstatut))), taux=repstatut) %>%
  ggplot(aes(y=statut, x=taux)) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.37)) +
  geom_text(aes(label=scales::percent(repstatut, accuracy=1)),
            stat="identity", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion of sent invitations", y="")
```
```{r echo=FALSE}
repinstitut <- c(`IN2P3 (nuclear and particle physics)` = 25.8351893095768, 
`INC (chemistry)` = 20.4927884615385, `INEE (ecology and environment)` = 27.920910724985, 
`INP (physics)` = 26.5788028555739, `IN2I (information sciences)` = 20.7792207792208, 
`INSB (biological sciences)` = 20.6474983020149, 
`INSHS (human and social sciences)` = 20.4694511563687, 
`INSIS (engineering and systems sciences)` = 21.0496929089894, 
`INSMI (mathematical sciences)` = 22.4460431654676, 
`INSU (earth and universe sciences)` = 31.2090790048014, 
`Chairmanship and general management` = 24.4859813084112)/100

data.frame(statut=factor(names(repinstitut)), taux=repinstitut) %>%
  mutate(statut=fct_reorder(statut, taux)) %>%
  ggplot(aes(y=statut, x=taux)) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.32)) +
  geom_text(aes(label=scales::percent(repinstitut, accuracy=1)),
            stat="identity", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion of sent invitations", y="")
```

Logistic regression on the probability of response:

|**Variable**                                                                  |**Odds ratio** |**95% CI** |
|:-----------------------------------------------------------------------------|:--------------|:------------|
|**Institute**                                                                 |               |             |
|INSU (earth and universe sciences)                                            |—              |             |
|INEE (ecology and environment)                                                |0.88           |0.76, 1.01   |
|INP (physics)                                                                 |0.81**         |0.70, 0.93   |
|IN2P3 (nuclear and particle physics)                                          |0.69***        |0.58, 0.83   |
|Chairmanship and general management                                           |0.63***        |0.53, 0.75   |
|INSMI (mathematical sciences)                                                 |0.73***        |0.62, 0.86   |
|INSIS (engineering and systems sciences)                                      |0.65***        |0.57, 0.74   |
|IN2I (information sciences)                                                   |0.66***        |0.57, 0.76   |
|INSB (biological sciences)                                                    |0.56***        |0.50, 0.63   |
|INC (chemistry)                                                               |0.60***        |0.53, 0.68   |
|INSHS (human and social sciences)                                             |0.65***        |0.58, 0.73   |
|**Region**                                                                    |               |             |
|01, Ile-de-France Villejuif                                                   |—              |             |
|02, Paris-Centre                                                              |1.06           |0.92, 1.23   |
|04, Ile-de-France Gif-sur-Yvette                                              |1.20*          |1.03, 1.40   |
|05, Ile-de-France Meudon                                                      |1.16           |0.97, 1.38   |
|06, Centre-Est                                                                |1.21*          |1.02, 1.44   |
|07, Rhône Auvergne                                                            |1.25**         |1.08, 1.46   |
|08, Centre-Limousin-Poitou-Charentes                                          |1.37**         |1.13, 1.66   |
|10, Alsace                                                                    |1.13           |0.94, 1.36   |
|11, Alpes                                                                     |1.70***        |1.45, 2.00   |
|12, Provence et Corse                                                         |1.29**         |1.10, 1.52   |
|13, Occitanie Est                                                             |1.13           |0.95, 1.34   |
|14, Occitanie Ouest                                                           |1.18*          |1.01, 1.38   |
|15, Aquitaine                                                                 |1.26*          |1.06, 1.51   |
|16, Paris Michel-Ange                                                         |1.10           |0.86, 1.41   |
|17, Bretagne et Pays de la Loire                                              |1.25**         |1.07, 1.46   |
|18, Hauts-de-France                                                           |1.00           |0.82, 1.20   |
|19, Normandie                                                                 |1.54***        |1.22, 1.93   |
|20, Côte d'Azur                                                               |0.93           |0.74, 1.16   |
|**Status**                                                                    |               |             |
|Senior researcher                                                             |—              |             |
|Full professor                                                                |0.55***        |0.48, 0.63   |
|Tenured researcher                                                            |1.27***        |1.11, 1.45   |
|Associate professor                                                           |0.73***        |0.64, 0.82   |
|Research engineer                                                             |1.12           |0.96, 1.31   |
|Postdoctoral researcher                                                       |0.49***        |0.39, 0.61   |
|Fully funded PhD student                                                      |0.47***        |0.42, 0.53   |
|Research support engineer                                                     |0.93           |0.81, 1.08   |
|Engineer assistant                                                            |0.70***        |0.59, 0.83   |
|Technician                                                                    |0.38***        |0.33, 0.45   |
|Temp on fixed-term contract                                                   |0.59***        |0.51, 0.68   |
|Other personnel                                                               |0.47***        |0.39, 0.56   |
|**Sex**                                                                       |               |             |
|Man                                                                           |—              |             |
|Woman                                                                         |1.31***        |1.23, 1.39   |

## Distribution of sample by discipline and status

```{r echo=FALSE}
knitr::kable(freq(climat$discipline_agr4))
knitr::kable(freq(climat$sitpro_reduite))
```

## Differences between early and late respondents 

To what degree are you concerned about climate change?
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$preoccupe2, climat$NumVague))))
```

If things continue on their present course, we will soon experience a major ecological catastrophe
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$opinionecolo.cata, climat$NumVague))))
```

I agree with having regulatory constraints (quotas, bans) put in place to protect the environment, even if it limits my comfort
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$opinionecolo.contraintes, climat$NumVague))))
```

Protecting the environment is more important than protecting economic growth
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$opinionecolo.proteger, climat$NumVague))))
```

France has committed to reducing its greenhouse gas emissions by one-third by 2030. In this respect, do you think that public research should:
```{r echo=FALSE}
knitr::kable(round(cprop(table(climatRegr$solreducrech2, climat$NumVague))))
```

What actions should research institutions and laboratories take to reduce their greenhouse gas emissions?

- Impose a cap on the number of flights per person
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$solinstit.limitevols, climat$NumVague))))
```

- Add carbon emissions to the main selection criteria for project funding
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$solinstit.selection, climat$NumVague))))
```
- Reduce the importance of conferences and presentations abroad in career assessments
```{r echo=FALSE}
knitr::kable(round(cprop(table(climat$solinstit.conf, climat$NumVague))))
```

Linear regressions on the number of reminders sent before the questionnaire was completed:
```{r echo=FALSE}
model_1 <- lm(vaguenum ~ sexe + ageAgr, data=climatRegr )
model_2 <- lm(vaguenum ~ sexe + ageAgr + sitpro_reduite2  + discipline_agr4 , data=climatRegr )
model_3 <- lm(vaguenum ~ sexe + ageAgr + sitpro_reduite2  + discipline_agr4 + preoccupe2 , data=climatRegr )
model_4 <- lm(vaguenum ~ sexe + ageAgr + sitpro_reduite2  + discipline_agr4 + solreducrech2, data=climatRegr )
model_5 <- lm(vaguenum ~ sexe + ageAgr + sitpro_reduite2  + discipline_agr4 + preoccupe2 + opinionecolo.cata+ opinionecolo.contraintes +       opinionecolo.proteger + solreducrech2 + solinstit.limitevols + solinstit.selection + solinstit.conf, data=climatRegr )
model_6 <- lm(vaguenum ~ sexe + ageAgr + sitpro_reduite2  + discipline_agr4 + carriere + malpaye + international.naiss, data=climatRegr )

table_1 <- 
  tbl_regression(model_1, label=list(sexe ~ "Sex", ageAgr ~ "Age"),
                 intercept=TRUE) %>% 
  add_significance_stars() %>%
  bold_labels() %>%
  add_glance_table(include = c(nobs, r.squared, adj.r.squared))

table_2 <- 
  tbl_regression(model_2, label=list(sexe ~ "Sex", ageAgr ~ "Age", sitpro_reduite2  ~ "Status", discipline_agr4~"Discipline"),
                 intercept=TRUE) %>% 
  add_significance_stars() %>%
  bold_labels() %>%
  add_glance_table(include = c(nobs, r.squared, adj.r.squared))

table_3 <- 
  tbl_regression(model_3, label=list(sexe ~ "Sex", ageAgr ~ "Age", sitpro_reduite2  ~ "Status", discipline_agr4~"Discipline", preoccupe2 ~ "Degree of concern about climate change"),
                 intercept=TRUE) %>% 
  add_significance_stars() %>%
  bold_labels() %>%
  add_glance_table(include = c(nobs, r.squared, adj.r.squared))

table_4 <- 
  tbl_regression(model_4, label=list(sexe ~ "Sex", ageAgr ~ "Age", sitpro_reduite2  ~ "Status", discipline_agr4~"Discipline", solreducrech2 ~ "Desirable GHGs emission reduction target for public research by 2030"),
                 intercept=TRUE) %>% 
  add_significance_stars() %>%
  bold_labels() %>%
  add_glance_table(include = c(nobs, r.squared, adj.r.squared))

table_5 <- 
  tbl_regression(model_5, label=list(sexe ~ "Sex", ageAgr ~ "Age", sitpro_reduite2  ~ "Status", discipline_agr4~"Discipline", preoccupe2 ~ "Degree of concern about climate change", opinionecolo.cata ~ "A major ecological catastrophe is going to occur", opinionecolo.contraintes ~ "A major ecological catastrophe is going to occur", opinionecolo.proteger ~ "Protecting the environment is more important than protecting economic growth", solreducrech2 ~ "Desirable GHG emission reduction target for public research by 2030", solinstit.limitevols ~ "Impose a cap on the number of flights per person", solinstit.selection ~ "Add carbon emissions to the main selection criteria for project funding",solinstit.conf ~ "Reduce the importance of conferences and presentations abroad in career assessments"),
                 intercept=TRUE) %>% 
  add_significance_stars() %>%
  bold_labels() %>%
  add_glance_table(include = c(nobs, r.squared, adj.r.squared))

table_6 <- 
  tbl_regression(model_6, label=list(sexe ~ "Sex", ageAgr ~ "Age", sitpro_reduite2  ~ "Status", discipline_agr4~"Discipline", carriere ~ "Being in a moment in one's career in which one is seeking to be promoted, recruited or tenured", malpaye~ "Feeling underpaid", international.naiss ~ "Born abroad"),
                 intercept=TRUE) %>% 
  add_significance_stars() %>%
  bold_labels() %>%
  add_glance_table(include = c(nobs, r.squared, adj.r.squared))


tbl_merge(list(table_1, table_2, table_3, table_4, table_5, table_6),
          paste("Model", 1:6)) %>%
  # ensure the glance statistics are at the bottom of table
  modify_table_body(~.x %>% dplyr::arrange(row_type == "glance_statistic"))
```

# Opinions

## Overview

Opinions of respondents on a selection of questions by discipline et status (%) :

```{r eval=FALSE, include=FALSE}
dat <- select(climat, changclim, preoccupe2, pluspreoccupe, acthum, chgtpratique, opinionecolo.cata, opinionecolo.effondrement2, solreducrech3)
summarytools::freq(dat, cumul=F, report.nas=F, style="rmarkdown", round.digits=0, display.type=F)

```

```{r echo=FALSE}
knitr::kable(round(
cbind("Climate is definitely changing"=lprop(table(climat$discipline_agr4, climat$changclim), drop = F)[,"Yes, definitely"],
      "Very or extremely concerned"=lprop(table(climat$discipline_agr4, climat$preoccupe2), drop = F)[,"Very concerned"] +
lprop(table(climat$discipline_agr4, climat$preoccupe2), drop = F)[,"Extremely concerned"],
      "Much more concerned than 5 years ago"=lprop(table(climat$discipline_agr4, climat$pluspreoccupe), drop = F)[,"Much more"],
      "Human activites cause climate change"=lprop(table(climat$discipline_agr4, climat$acthum), drop = F)[,"Yes, they play a major role"]+
       lprop(table(climat$discipline_agr4, climat$acthum), drop = F)[,"Yes, they are the only cause"],
      "Calls for profound changes in our professions"=lprop(table(climat$discipline_agr4, climat$chgtpratique), drop = F)[,"Yes, strongly agree"] +
  lprop(table(climat$discipline_agr4, climat$chgtpratique), drop = F)[,"Yes, somewhat agree"],
      "We will soon experience an ecological catastrophe"=lprop(table(climat$discipline_agr4, climat$opinionecolo.cata), drop = F)[,"Completely agree"]+
  lprop(table(climat$discipline_agr4, climat$opinionecolo.cata), drop = F)[,"Somewhat agree"],
      "It could cause a collapse of our societies"=lprop(table(climat$discipline_agr4, climat$opinionecolo.effondrement2), drop = F)[,"Completely agree"]+
  lprop(table(climat$discipline_agr4, climat$opinionecolo.effondrement2), drop = F)[,"Somewhat agree"],
  "Research must reduce its emissions by more than one-third"=
    lprop(table(climat$discipline_agr4, climat$solreducrech3), drop = F)[,"More than one-third"])))

knitr::kable(round(
cbind("Climate is definitely changing"=lprop(table(climat$sitpro_reduite, climat$changclim), drop = F)[,"Yes, definitely"],
      "Very or extremely concerned"=lprop(table(climat$sitpro_reduite, climat$preoccupe2), drop = F)[,"Very concerned"] +
lprop(table(climat$sitpro_reduite, climat$preoccupe2), drop = F)[,"Extremely concerned"],
      "Much more concerned than 5 years ago"=lprop(table(climat$sitpro_reduite, climat$pluspreoccupe), drop = F)[,"Much more"],
      "Human activites cause climate change"=lprop(table(climat$sitpro_reduite, climat$acthum), drop = F)[,"Yes, they play a major role"]+
       lprop(table(climat$sitpro_reduite, climat$acthum), drop = F)[,"Yes, they are the only cause"],
      "Calls for profound changes in our professions"=lprop(table(climat$sitpro_reduite, climat$chgtpratique), drop = F)[,"Yes, strongly agree"] +
  lprop(table(climat$sitpro_reduite, climat$chgtpratique), drop = F)[,"Yes, somewhat agree"],
      "We will soon experience an ecological catastrophe"=lprop(table(climat$sitpro_reduite, climat$opinionecolo.cata), drop = F)[,"Completely agree"]+
  lprop(table(climat$sitpro_reduite, climat$opinionecolo.cata), drop = F)[,"Somewhat agree"],
      "It could cause a collapse of our societies"=lprop(table(climat$sitpro_reduite, climat$opinionecolo.effondrement2), drop = F)[,"Completely agree"]+
  lprop(table(climat$sitpro_reduite, climat$opinionecolo.effondrement2), drop = F)[,"Somewhat agree"],
  "Research must reduce its emissions by more than one-third"=
    lprop(table(climat$sitpro_reduite, climat$solreducrech3), drop = F)[,"More than one-third"])))
```

## Human activities and climate change
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(6, "RdYlGn")
ggplot(drop_na(climat, acthum3),
       aes(y=fct_rev(acthum3), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", pal[c(1, 2, 4, 6)])) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 1)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1)),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion of respondents", y="",
       title="Are human activities the cause of climate change\n(rise in temperatures in the last century)?") +
  source_champ(nrow(drop_na(climat, acthum3)),
               "For 95.1% of respondents, human activities play a major role or are the only cause of climate change.")
```

```{r echo=FALSE}
climat$acthum4 <- climat$acthum3
levels(climat$acthum4) <- gsub("\n", " ", levels(climat$acthum3))
knitr::kable(freq(climat$acthum2))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$acthum4))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$acthum4))))
```

## Concern about climate change
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, preoccupe),
       aes(y=fct_relevel(preoccupe, "No opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#74add1", "#fee090", "#fdae61", "#f46d43", "#d73027")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.42)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1)),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion of respondents", y="",
       title="To what degree are you concerned about climate change?") +
  source_champ(nrow(drop_na(climat, preoccupe)),
               "Interpretation: 31.7% of respondents are extremely concerned about climate change")

```

```{r echo=FALSE}
knitr::kable(freq(climat$preoccupe2))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$preoccupe2))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$preoccupe2))))
```


## Change in degree of concern
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, pluspreoccupe),
       aes(y=fct_relevel(fct_rev(pluspreoccupe), "No opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#74add1", "#e5f5f9", "#dfc27d", "#f46d43", "#d73027")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.46)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1)),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  theme(plot.title=element_text(size=10), plot.subtitle=element_text(size=8)) +
  labs(x="Proportion of respondents", y="",
       title="Are you more or less concerned about climate change than 5 years ago?") +
  source_champ(nrow(drop_na(climat, pluspreoccupe)),
               "Interpretation: 44.6% of respondents are much more concerned about climate change than 5 years ago")
```

```{r echo=FALSE}
knitr::kable(freq(climat$pluspreoccupe))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$pluspreoccupe))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$pluspreoccupe))))
```

## Opinions on ecology in general
```{r echo=FALSE, fig.height=5.5}
dat <- rbind(data.frame(variable="There is no point in me making an effort for the environment\nif others do not do the same", valeur=climat$opinionecolo.efforts),
data.frame(variable="Most environmental problems can be solved\nby applying more and better technology",
                        valeur=climat$opinionecolo.techno),
             data.frame(variable="Degrowth is necessary to face environmental challenges", valeur=climat$opinionecolo.decroissance),
             data.frame(variable="I agree with having regulatory constraints\nput in place to protect the environment,\neven if it limits my comfort", valeur=climat$opinionecolo.contraintes),
             data.frame(variable="Protecting the environment is more important\nthan protecting economic growth", valeur=climat$opinionecolo.proteger),
             data.frame(variable="This type of catastrophe could cause a collapse\nof our societies*", valeur=climat$opinionecolo.effondrement2),
             data.frame(variable="If things continue on their present course,\nwe will soon experience a major ecological catastrophe", valeur=climat$opinionecolo.cata)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("Completely agree", "Somewhat agree", "No opinion", "Somewhat disagree", "Completely disagree")))

knitr::kable(table_multi(dat))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "#fdae61", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
    labs(y="Proportion of respondents", x="") +
    source_champ(max(table(drop_na(dat)$variable)),
                  "* Respondents disagreeing with previous question are classified as “Strongly disagree”
Interpretation: 59% of respodents completely agree with the statement that\nwe will soon experience a major ecological catastrophe")
```

If things continue on their present course, we will soon experience a major ecological catastrophe
```{r echo=FALSE}
knitr::kable(freq(climat$opinionecolo.cata))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$opinionecolo.cata))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$opinionecolo.cata))))
```

This type of catastrophe could cause a collapse of our societies: the basic needs (food, energy, health, etc.) will no longer be assured for the majority of the population
```{r echo=FALSE}
knitr::kable(freq(climat$opinionecolo.effondrement2))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$opinionecolo.effondrement2))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$opinionecolo.effondrement2))))
```
(Respondents disagreeing with previous question are classified as “Strongly disagree”)

## Profound changes in our professions
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, chgtpratique),
       aes(y=fct_relevel(fct_rev(chgtpratique), "No opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#d7191c", "#fdae61", "#a6d96a", "#1a9641")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.60)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1)),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  theme(plot.title=element_text(size=10),
        plot.subtitle=element_text(size=8)) +
  labs(x="Proportion of respondents", y="",
       title="Do you think that climate urgency calls for profound changes in the practice of our professions?") +
  source_champ(nrow(drop_na(climat, chgtpratique)),
               "Interpretation: 47% of respondents think that climate urgency calls for profound changes in the practice of our professions")
```

```{r echo=FALSE}
knitr::kable(freq(climat$chgtpratique))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$chgtpratique))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$chgtpratique))))
```

## Reduction in emissions by one-third by 2030
```{r echo=FALSE}
climat$solreducrech4 <- fct_recode(factor(climat$solreducrech), "Set an example\n(reduce emissions by more than one-third)"="Set an example (reduce emissions by more than one-third)", "Benefit from an exemption\n(reduce emissions by less than one-third)"="Benefit from an exemption (reduce emissions by less than one-third)")

ggplot(drop_na(climat, solreducrech4),
       aes(y=fct_rev(solreducrech4), x=..prop.., group=1)) +
    geom_bar(fill=c("#d7191c", "#a6d96a", "#1a9641")) +
    scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
    coord_cartesian(xlim=c(0, 0.5)) +
    geom_text(aes(label=scales::percent(..prop.., accuracy=1)),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
    labs(x="Proportion of respondents", y="",
         title="France has committed to reducing its greenhouse gas emissions\nby one-third by 2030.\nIn this respect, do you think that public research should:") +
  source_champ(nrow(drop_na(climat, solreducrech4)),
               "Interpretation: 48% of respondents think that public research should reduce its emissions by more than one-third by 2030")
```

```{r echo=FALSE}
knitr::kable(freq(climat$solreducrech3))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$solreducrech3))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$solreducrech3))))
```

# Practices

## Flights

Analyses in this section cover only PhD-level positions (researchers, professors, research engineers and PhD students).

```{r echo=FALSE}
# # sous base seulement recherche
climat_recherche <- subset(climat, ! sitpro %in% c(
  "Ingénieur·e d'études", "Assistant ingénieur·e", "Technicien·ne",
  "Chargé·e d'études/de mission","Adjoint·e technique",
  "Autre"))

```

### Reasons for flying by discipline


```{r echo=FALSE}

climat_recherche$discipline_agr4b <- fct_recode(factor(climat_recherche$discipline_agr4), "History, geogr., urbanism, anthropol."="History, geography, urbanism, anthropology", "Meteo., oceano., environmental physics"="Meteorology, oceanology, environmental physics")

a <- tapply(climat_recherche$volsdist_totterrain, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)
b <- tapply(climat_recherche$volsdist_totsejrech, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)
c <- tapply(climat_recherche$volsdist_totworkshop, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)
d <- tapply(climat_recherche$volsdist_totcours, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)
e <- tapply(climat_recherche$volsdist_totjury, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)+
    tapply(climat_recherche$volsdist_totfinanc, 
           climat_recherche$discipline_agr4b, mean, na.rm=T)+
    tapply(climat_recherche$volsdist_toteval, 
           climat_recherche$discipline_agr4b, mean, na.rm=T)+
    tapply(climat_recherche$volsdist_totautre, 
           climat_recherche$discipline_agr4b, mean, na.rm=T)
j <- tapply(climat_recherche$volsdist_totconf, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)
total <- tapply(climat_recherche$volsdist_tot, 
            climat_recherche$discipline_agr4b, mean, na.rm=T)


table <- cbind(a,b,c,d,e,j, total)
colnames(table) <- c("Fieldwork, data",
                     "Research stay",
                     "Meeting, workshop",
                     "Teaching, training",
                     "Others",
                     "Conference, presentation", 
                     "Total")

table <- as.data.frame(as.table(table))

niveaux <- names(sort(tapply(climat_recherche$volsdist_tot, 
                             climat_recherche$discipline_agr4b, mean, na.rm=T)))
table$Var1 <- fct_relevel(table$Var1, niveaux)

#ordonnes par poids dans le total des distances parcourues
table$Var2 <- fct_relevel(table$Var2,
                          c("Others",
                            "Teaching, training",
                            "Fieldwork, data",
                            "Meeting, workshop",
                            "Research stay",
                            "Conference, presentation", 
                            "Total"))

# cols <- brewer.pal(n=6, "Set2")
ggplot(table[table$Var2!="Total",]) + 
  geom_bar(aes(x=Var1, y=Freq, fill=Var2), stat="identity")+
  coord_flip(ylim=c(0, 15000)) +
  # scale_fill_manual(values=rev(as.vector(cols[1:6])))+
  scale_fill_paletteer_d("ggthemes::excel_Celestial")+
  labs(x="", y="Distance travelled by plane in 2019 (km)", fill="")+
  guides(fill=guide_legend(reverse = TRUE))

```


Distance travelled by plane in 2019 (km):
```{r echo=FALSE}
tableau <- table %>% pivot_wider(names_from=Var2, values_from=Freq) 
colnames(tableau)[1] = "Discipline"
knitr::kable(tableau, digits =0)
```

Distance travelled by plane in 2019 (row %):
```{r echo=FALSE}
tableau <- as.data.frame(tableau)
tableaupct = 100*tableau[,2:8]/tableau[,8]
tableaupct = cbind(tableau[,1], tableaupct)
colnames(tableaupct)[1] = "Discipline"
knitr::kable(tableaupct, digits =0)
```


```{r echo=FALSE}
ggplot(table[table$Var2=="Total",],
       aes(x=Var1, y=Freq)) +
  stat_summary(geom="bar", fun=mean, na.rm=TRUE) +
  stat_summary(
    geom="errorbar", fun.data=mean_cl_normal, 
    na.rm=TRUE, width=0.2)+
  coord_flip(ylim=c(0, 15000)) +
  # scale_fill_manual(values=rev(as.vector(cols[1:6])))+
  scale_fill_paletteer_d("ggthemes::excel_Celestial")+
  labs(x="", y="Distance travelled by plane in 2019 (km)")
```




### Reasons for flying by status


```{r echo=FALSE}
a <- tapply(climat_recherche$volsdist_totterrain, 
            climat_recherche$sitpro_reduite, mean, na.rm=T)
b <- tapply(climat_recherche$volsdist_totsejrech, 
            climat_recherche$sitpro_reduite, mean, na.rm=T)
c <- tapply(climat_recherche$volsdist_totworkshop, 
            climat_recherche$sitpro_reduite, mean, na.rm=T)
d <- tapply(climat_recherche$volsdist_totcours, 
            climat_recherche$sitpro_reduite, mean, na.rm=T)
e <- tapply(climat_recherche$volsdist_totjury, 
            climat_recherche$sitpro_reduite, mean, na.rm=T)+
    tapply(climat_recherche$volsdist_totfinanc, 
           climat_recherche$sitpro_reduite, mean, na.rm=T)+
    tapply(climat_recherche$volsdist_toteval, 
           climat_recherche$sitpro_reduite, mean, na.rm=T)+
    tapply(climat_recherche$volsdist_totautre, 
           climat_recherche$sitpro_reduite, mean, na.rm=T)
j <- tapply(climat_recherche$volsdist_totconf, 
            climat_recherche$sitpro_reduite, mean, na.rm=T)
total <- tapply(climat_recherche$volsdist_tot, 
                climat_recherche$sitpro_reduite, mean, na.rm=T)

table <- cbind(a,b,c,d,e,j, total)
colnames(table) <- c("Fieldwork, data",
                     "Research stay",
                     "Meeting, workshop",
                     "Teaching, training",
                     "Others",
                     "Conference, presentation", 
                     "Total")

table <- as.data.frame(as.table(table))
#ordonnes par poids dans le total des distances parcourues
table$Var2 <- fct_relevel(table$Var2,
                          c("Others",
                            "Teaching, training",
                            "Fieldwork, data",
                            "Meeting, workshop",
                            "Research stay",
                            "Conference, presentation", 
                            "Total"))

ggplot(table[table$Var2!="Total"&
               table$Var1%in%c(levels(table$Var1)[1:8]),]) + 
  geom_bar(aes(x=fct_rev(Var1), y=Freq, fill=Var2), stat="identity")+
  coord_flip(ylim=c(0, 15000)) +
  # scale_fill_manual(values=rev(as.vector(cols[1:6])))+
  scale_fill_paletteer_d("ggthemes::excel_Celestial")+
  labs(x="", y="Distance travelled by plane in 2019 (km)", fill="")+
  guides(fill=guide_legend(reverse = TRUE))

```


Distance travelled by plane in 2019 (km):
```{r echo=FALSE}
tableau <- table %>% pivot_wider(names_from=Var2, values_from=Freq)
colnames(tableau)[1] = "Status"
knitr::kable(tableau[1:8,], digits =0)
```

Distance travelled by plane in 2019 (row %):
```{r echo=FALSE}
tableau <- as.data.frame(tableau)
tableaupct = 100*tableau[,2:8]/tableau[,8]
tableaupct = cbind(tableau[,1], tableaupct)
colnames(tableaupct)[1] = "Status"
knitr::kable(tableaupct[1:8,], digits =0)
```



## IT equipment
```{r echo=FALSE}
climat$ordis.5anstotalproplus0 <- ifelse(climat$ordis.5anstotalpro > 0, "At least one device under 5 years old", "No device under 5 years old")
climat$ordis.nbtotalproplus1 <- ifelse(climat$ordis.nbtotalpro > 1, "Several devices", "No device or a single device")
climat$ordis.tousindisp <- ifelse(climat$ordis.nbtotalpro > climat$ordis.indisptotalpro, "All devices considered essential", "Some devices considered non-essential")

knitr::kable(freq(climat$ordis.5anstotalproplus0))
knitr::kable(freq(climat$ordis.nbtotalproplus1))
knitr::kable(round(lprop(table(climat$ordis.nbtotalproplus1, climat$ordis.tousindisp))))

knitr::kable(round(lprop(table(climat$discipline_agr4, climat$ordis.5anstotalproplus0))))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$ordis.nbtotalproplus1))))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$ordis.tousindisp))))

knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$ordis.5anstotalproplus0))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$ordis.nbtotalproplus1))))
```

## Leftover budget money

```{r echo=FALSE}
    knitr::kable(freq(ifelse(climat$reliquat.avion != "I have not had leftover budget money to spend" | climat$reliquat.ordi != "I have not had leftover budget money to spend", "Has had leftover budget money to spend", "Has not had leftover budget money to spend")))
```

Having used leftover budget money to buy IT equipment considered as non-essential:
```{r echo=FALSE}
knitr::kable(freq(climat$reliquat.ordi))
knitr::kable(freq(fct_recode(climat$reliquat.ordi, NULL="I have not had leftover budget money to spend")))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$reliquat.ordi))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$reliquat.ordi))))
```

Having used leftover budget money to buy plane tickets considered as non-essential:
```{r echo=FALSE}
knitr::kable(freq(climat$reliquat.avion))
knitr::kable(freq(fct_recode(climat$reliquat.avion, NULL="I have not had leftover budget money to spend")))
knitr::kable(round(lprop(table(climat$discipline_agr4, climat$reliquat.avion))))
knitr::kable(round(lprop(table(climat$sitpro_reduite, climat$reliquat.avion))))
```

# Solutions

## Reductions in personal GHG emissions in a professional setting by 2030

Are you willing to reduce your greenhouse gas emissions by 2030 in the following areas?

```{r echo=FALSE}
dat <- rbind(data.frame(variable="Scientific experiments and observations", valeur=climat$solreducperso.exp),
             data.frame(variable="Travel for fieldwork, observation\nor data collection (by plane, car or boat)", valeur=climat$solreducperso.donnees),
             data.frame(variable="Commuting to work by car, motorbike,\nscooter or plane", valeur=climat$solreducperso.domicile),
             data.frame(variable="IT equipment and its replacement rates", valeur=climat$solreducperso.info),
             data.frame(variable="Flights for conferences, meetings,\nand congresses", valeur=climat$solreducperso.conf)) %>%
  mutate(variable=factor(variable, levels=unique(variable)),
         valeur=fct_relevel(valeur, c("Yes, by at least one-third", "Yes, but by less than one-third", "No, as they are already very low", "No opinion", "No")))

knitr::kable(table_multi(dat))


```

Proportion of “No” anwsers, excluding those not concerned:

```{r echo=FALSE, results='asis', fig.height=6}
knitr::kable(round(
cbind("Scientific experiments and observations"=lprop(table(climat$discipline_agr4, climat$solreducperso.exp)[, levels(climat$solreducperso.exp) != "Not concerned"], drop = F)[,"No"],
      "Travel for fieldwork, observation or data collection (by plane, car or boat)"=lprop(table(climat$discipline_agr4, climat$solreducperso.donnees)[, levels(climat$solreducperso.donnees) != "Not concerned"], drop = F)[,"No"],
      "Commuting to work by car, motorbike, scooter or plane"=lprop(table(climat$discipline_agr4, climat$solreducperso.domicile)[, levels(climat$solreducperso.domicile) != "Not concerned"], drop = F)[,"No"], 
      "IT equipment and its replacement rates"=lprop(table(climat$discipline_agr4, climat$solreducperso.info)[, levels(climat$solreducperso.info) != "Not concerned"], drop = F)[,"No"], 
      "Flights for conferences, meetings, and congresses"=lprop(table(climat$discipline_agr4, climat$solreducperso.conf)[, levels(climat$solreducperso.conf) != "Not concerned"], drop = F)[,"No"]
)))

knitr::kable(round(
cbind("Scientific experiments and observations"=lprop(table(climat$sitpro_reduite, climat$solreducperso.exp)[, levels(climat$solreducperso.exp) != "Not concerned"], drop = F)[,"No"],
      "Travel for fieldwork, observation or data collection (by plane, car or boat)"=lprop(table(climat$sitpro_reduite, climat$solreducperso.donnees)[, levels(climat$solreducperso.donnees) != "Not concerned"], drop = F)[,"No"],
      "Commuting to work by car, motorbike, scooter or plane"=lprop(table(climat$sitpro_reduite, climat$solreducperso.domicile)[, levels(climat$solreducperso.domicile) != "Not concerned"], drop = F)[,"No"], 
      "IT equipment and its replacement rates"=lprop(table(climat$sitpro_reduite, climat$solreducperso.info)[, levels(climat$solreducperso.info) != "Not concerned"], drop = F)[,"No"], 
      "Flights for conferences, meetings, and congresses"=lprop(table(climat$sitpro_reduite, climat$solreducperso.conf)[, levels(climat$solreducperso.conf) != "Not concerned"], drop = F)[,"No"]
)))

drop_na(dat) %>%
  filter(valeur != "Not concerned") %>%
  ggplot(aes(x=variable)) +
  geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
  scale_fill_manual(values=c("#d7191c", "light grey", "#3690c0", "#66bd63", "#1a9641")) +
  scale_y_continuous(labels=scales::percent_format(),
                     sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
  coord_flip() + labs(fill="") +
  theme(legend.position="bottom") +
  guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
  labs(y="Proportion of respondents", x="",
       title="Are you willing to reduce your greenhouse gas emissions\nby 2030 in the following areas?") +
  source_champ(max(table(filter(drop_na(dat), valeur != "Not concerned")$variable)),
               "Note: the proportion of people concerned varies according to the question
Interpretation: 32% of respondents say they are unable to reduce the emissions they generate\nby flying to conferences as they are already very low")
```

## Risks associated with reduced flying

What would be the risks of implementing a policy on the reduction of professional air travel in research?

```{r echo=FALSE, results='asis', fig.height=6, fig.width=7.5}
dat <- rbind(data.frame(variable="Reduce some of the advantages offered to you\nby your profession", valeur=climat$solrisqreducavion.avantages),
             data.frame(variable="Reduce your access to funding", valeur=climat$solrisqreducavion.fin),
             data.frame(variable="Reduce the quality of your work", valeur=climat$solrisqreducavion.qual),
             data.frame(variable="Reduce the dissemination of your work", valeur=climat$solrisqreducavion.diffusion),
             data.frame(variable="Isolate French research\nfrom the rest of the world", valeur=climat$solrisqreducavion.isoler),
             data.frame(variable="Increase bureaucracy", valeur=climat$solrisqreducavion.bureaucratie),
             data.frame(variable="Hinder your access to some field sites\nor the collection/production of certain data", valeur=climat$solrisqreducavion.donnees),
             data.frame(variable="Hinder the integration of young researchers", valeur=climat$solrisqreducavion.insertion)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("It is likely and it is a problem", "It is likely but it is not a problem", "No opinion", "It is unlikely")))

knitr::kable(table_multi(dat))

drop_na(dat) %>%
    filter(valeur != "Not concerned") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion of respondents", x="",
         title="What would be the risks of implementing a policy on the reduction\nof professional air travel in research?") +
    source_champ(max(table(filter(drop_na(dat), valeur != "Not concerned")$variable)),
                 "Note: the proportion of people concerned varies according to the question
Interpretation: 54% of respondents think it likely that a reduction in the number of flights would negatively impact\nthe integration of young researchers and that it is a problem")
```

Proportion of “It is likely and it is a problem” answers, excluding those not concerned:

```{r echo=FALSE}

knitr::kable(round(
  cbind("Reduce the quality of your work"=lprop(table(climat$discipline_agr4, climat$solrisqreducavion.qual)[, levels(climat$solrisqreducavion.qual) != "Not concerned"], drop = F)[,"It is likely and it is a problem"],
        "Hinder your access to some field sites or the collection/production of certain data"=lprop(table(climat$discipline_agr4, climat$solrisqreducavion.donnees)[, levels(climat$solrisqreducavion.donnees) != "Not concerned"], drop = F)[,"It is likely and it is a problem"]
  )))

knitr::kable(round(
  cbind("Isolate French research from the rest of the world"=lprop(table(climat$sitpro_reduite, climat$solrisqreducavion.isoler)[, levels(climat$solrisqreducavion.isoler) != "Not concerned"], drop = F)[,"It is likely and it is a problem"],
        "Hinder the integration of young researchers"=lprop(table(climat$sitpro_reduite, climat$solrisqreducavion.insertion)[, levels(climat$solrisqreducavion.insertion) != "Not concerned"], drop = F)[,"It is likely and it is a problem"],
        "Reduce the dissemination of your work"=lprop(table(climat$sitpro_reduite, climat$solrisqreducavion.diffusion)[, levels(climat$solrisqreducavion.diffusion) != "Not concerned"], drop = F)[,"It is likely and it is a problem"]
  ))
)

```

## Reductions in personal GHG emissions of experimental equipment by 2030

Are you willing to reduce by 2030 the greenhouse gas emissions generated by the production and operation of equipment for your scientific experiments and observations by the following means?

```{r echo=FALSE, fig.height=6}
dat <- rbind(data.frame(variable="Using less equipment in experimental setups", valeur=climat$solreducmateriel.moins),
             data.frame(variable="Using equipment less frequently or less intensively", valeur=climat$solreducmateriel.util),
             data.frame(variable="Using or developing simpler systems (low-tech)", valeur=climat$solreducmateriel.lowtech),
             data.frame(variable="Replacing the equipment at a slower rate", valeur=climat$solreducmateriel.renouv)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("Yes, by at least one-third", "Yes, but by less than one-third", "No, as they are already very low", "No opinion", "No")))

knitr::kable(table_multi(dat, c("Yes, by at least one-third", "Yes, but by less than one-third", "No, as they are already very low", "No", "No opinion")))

drop_na(dat) %>%
    filter(valeur != "Not concerned") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#3690c0", "#66bd63", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
    labs(y="Proportion among respondents using experimental equipment", x="",
         title="Are you willing to reduce by 2030 the greenhouse gas emissions\ngenerated by the production and operation of equipment for your\nscientific experiments and observations by the following means?",
         caption=sprintf("Note: the proportion of people concerned varies according to the question.
Interpretation: 34%% of respondents say they are unable to reduce their emissions by replacing equipment at a slower rate\nbecause they are already very low.
Source: “Research personnel and climate change” survey, Labos 1point5, 2020
Coverage: personnel associated with a CNRS unit and using experimental equipment (n=%i)", max(table(filter(drop_na(dat), valeur != "Not concerned")$variable))))
```


## Risks associated with reduced emissions of experimental equipment

What would be the risks of a policy on reducing the greenhouse gas emissions generated by the production and operation of equipment for scientific experiments and observations?

```{r echo=FALSE, fig.height=6, fig.width=7.5}
dat <- rbind(data.frame(variable="Reduce the quality of your work", valeur=climat$solrisqreducmateriel.qual),
             data.frame(variable="Set you back compared with rival teams", valeur=climat$solrisqreducmateriel.retard),
             data.frame(variable="Reduce your access to funding", valeur=climat$solrisqreducmateriel.fin),
             data.frame(variable="Reduce your number of publications", valeur=climat$solrisqreducmateriel.publi),
             data.frame(variable="Require you to change research themes", valeur=climat$solrisqreducmateriel.themes)) %>%
    mutate(variable=factor(variable, levels=rev(unique(variable))),
           valeur=fct_relevel(valeur, c("It is likely and it is a problem", "It is likely but it is not a problem", "No opinion", "It is unlikely")))

knitr::kable(table_multi(dat))

drop_na(dat) %>%
    filter(valeur != "Not concerned") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=valeur), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion among respondents using experimental equipment", x="",
         title="What would be the risks of a policy on reducing the greenhouse gas\nemissions generated by the production and operation of equipment\nfor scientific experiments and observations?",
         caption=sprintf("Note: the proportion of people concerned varies according to the question
Interpretation: 54%% of respondents think it likely that a reduction in the number of flights would negatively impact the integration of young researchers and that it is a problem.
Source: “Research personnel and climate change” survey, Labos 1point5, 2020\nCoverage: personnel associated with a CNRS unit and using experimental equipment (n=%i)", max(table(filter(drop_na(dat), valeur != "Not concerned")$variable))))
```

## Institutional solutions

What actions should research institutions and laboratories take to reduce their greenhouse gas emissions? 

```{r echo=FALSE, fig.height=7, fig.width=7.5}
dat <- rbind(data.frame(variable="Add carbon emissions to the main selection criteria\nfor project funding", valeur=climat$solinstit.selection),
             data.frame(variable="Impose a cap on the number\nof flights per person", valeur=climat$solinstit.limitevols),
             data.frame(variable="Finance carbon offsetting initiatives", valeur=climat$solinstit.compensation),
             data.frame(variable="Reduce the importance of conferences\nand presentations abroad in career assessments", valeur=climat$solinstit.conf),
             data.frame(variable="Regularly draft and disseminate\ndetailed carbon assessments", valeur=climat$solinstit.bilanges),
             data.frame(variable="Prohibit air travel when the same journey takes\nless than 6 hours by train", valeur=climat$solinstit.vols6h),
             data.frame(variable="Do not renew functional computer equipment\nbefore a minimum of 5 years of age", valeur=climat$solinstit.info),
             data.frame(variable="Finance train tickets even if more expensive\nor requires a longer stay", valeur=climat$solinstit.train),
             data.frame(variable="When organising events, prefer service providers\noffering local or vegetarian food", valeur=climat$solinstit.vege),
             data.frame(variable="When replacing equipment, prefer those consuming\nless energy even if more expensive", valeur=climat$solinstit.equip)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("It is a priority", "It is secondary", "No opinion", "It should not be implemented")))

knitr::kable(table_multi(dat))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion of respondents", x="",
         title="What actions should research institutions and laboratories take\nto reduce their greenhouse gas emissions?") +
  source_champ(max(table(drop_na(dat)$variable)),
               "Interpretation: 75% of respondents think that choosing more energy-efficient equipment is a priority")
```