---
title: Premiers résultats de l’enquête « Les personnels de la recherche face au changement
  climatique »
output:
  html_document:
    fig_width: 7.5
    fig_height: 4.5
    fontsize: 12pt
    highlight: haddock
    number_sections: yes
    theme: united
    toc: yes
    toc_float: yes
---

```{r preparation, echo=FALSE, message=FALSE}
library(tidyverse)
library(ggplot2)
load("climat.RData")
source("recodages.R", encoding = "UTF-8")
theme_set(theme_minimal() + theme(plot.title=element_text(size=11)))
update_geom_defaults("bar", list(fill="#045a8d"))
update_geom_defaults("col", list(fill="#045a8d"))

texte_legende <- "Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : personnels affiliés à une unité du CNRS"
source_champ <- function(n=NA, extra=NA) {
  if(is.na(n))
    texte <- texte_legende
  else
    texte <- paste0(texte_legende, " (n=", n, ")")

  if(is.na(extra))
    labs(caption=texte)
  else
    labs(caption=paste(extra, texte, sep="\n"))
}
```

Ce document est complémentaire des documents contenant le questionnaire complet et une présentation générale de l'enquête (liens ?). Il vise à rendre rapidement public les réponses à une sélection de questions, sans avoir recours à des traitements statistiques avancés et sans fournir d'interprétation. Il prend la forme d'une série de graphiques permettant de visualiser facilement ce que les participant·es à l'enquête ont répondu.
Il s'agit d'un document d'étape qui pourra être modifié et complété par la suite. 

# Taux de réponse

## Taux de réponse global

Sur les 30 000 adresses tirées au sort, 134 étaient en doublon, et 1373 (soit 4,6 %) ont généré une erreur lors de l'envoi du message d'invitation. Notons que les serveurs ne signalent pas systématiquement une erreur lorsque le message n'a pas pu être délivré, sans compter l'action des filtres anti-spam et les boîtes inutilisées : il est probable qu'une proportion bien plus élevée des invitations n'ont jamais été reçues.

6723 personnes, correspondant à 23,6 % des invitations envoyées, ont dépassé la page d'accueil du questionnaire. 6469 personnes (soit 22,7 % des invitations) ont terminé la première page du questionnaire, et 5682 (19,9 % des invitations) ont répondu à l'ensemble du questionnaire. Seul·es 15% des répondant·es ont donc abandonné en cours de route.

## Taux de réponse par statut

```{r echo=FALSE}
repstatut <- c(`Autre personnel` = 11.9106699751861, `Chercheur·e` = 33.0119375573921, 
`Doctorant·e` = 17.0106132075472, `Enseignant·e-chercheur·e` = 21.9991862199919, 
`Ingénieur·e` = 27.7703604806409, `Ingénieur·e de recherche` = 33.5389360061681, 
`Post-doctorant·e` = 17.5438596491228, `Technicien·ne/administratif·ve` = 15.253386853989, 
`Temporaire sur CDD` = 21.2341197822142)/100

data.frame(statut=factor(names(repstatut)), taux=repstatut) %>%
  mutate(statut=fct_reorder(statut, taux)) %>%
  ggplot(aes(y=statut, x=taux)) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.35)) +
  geom_text(aes(label=scales::percent(repstatut, accuracy=1, decimal.mark=",")),
            stat="identity", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion", y="",
       title="Taux de réponse à la première page du questionnaire selon le statut", 
       caption="Lecture : 34% des ingénieur·es de recherche à qui une invitation a été envoyée
       ont répondu au moins à la première page du questionnaire.")
```

## Taux de réponse par institut

```{r echo=FALSE}
repinstitut <- c(`IN2P3 (physique nucléaire et des particules)` = 25.8351893095768, 
`INC (chimie)` = 20.4927884615385, `INEE (écologie et environnement)` = 27.920910724985, 
`INP (physique)` = 26.5788028555739, `INS2I (sciences de l'information)` = 20.7792207792208, 
`INSB (sciences biologiques)` = 20.6474983020149, 
`INSHS (sciences humaines et sociales)` = 20.4694511563687, 
`INSIS (sciences de l'ingénierie et des systèmes)` = 21.0496929089894, 
`INSMI (sciences mathématiques)` = 22.4460431654676, 
`INSU (sciences de l'univers)` = 31.2090790048014, 
`Présidence et Direction générale` = 24.4859813084112)/100

data.frame(statut=factor(names(repinstitut)), taux=repinstitut) %>%
  mutate(statut=fct_reorder(statut, taux)) %>%
  ggplot(aes(y=statut, x=taux)) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.32)) +
  geom_text(aes(label=scales::percent(repinstitut, accuracy=1, decimal.mark=",")),
            stat="identity", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des invitations envoyées", y="",
       title="Taux de réponse à la première page\ndu questionnaire selon l'institut", 
       caption="Lecture : 31% des personnes affiliées à l'INSU à qui une invitation a été envoyée
       ont répondu au moins à la première page du questionnaire.")
```

# Informations générales

## Statut d'emploi

```{r echo=FALSE}
ggplot(drop_na(climat, statut),
       aes(y=fct_rev(statut), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.69)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Statut d'emploi principal") +
  source_champ(nrow(drop_na(climat, statut)),
               "Lecture : 65,8% des répondant·es sont fonctionnaires.")
```

## Situation professionnelle

```{r echo=FALSE}
ggplot(drop_na(climat, sitpro),
       aes(y=fct_rev(sitpro), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.17)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Situation professionnelle principale") +
  source_champ(nrow(drop_na(climat, sitpro)),
               "Lecture : 13% des répondant·es sont doctorant·es contractuel·les.")
```


## Doctorant·es

Il y a 18% de doctorant·es (toutes situations confondues) dans l'échantillon.

## Disciplines et BAP


```{r echo=FALSE}
ggplot(drop_na(climat, discipline_agr),
       aes(y=fct_rev(discipline_agr), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.15)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Discipline principale") +
  source_champ(nrow(drop_na(climat, discipline_agr)),
               "Lecture : 15% des répondant·es ont une discipline principale relevant des sciences humaines.")
```
```{r echo=FALSE}
drop_na(climat, bap) %>%
  filter(bap != "Je ne sais pas") %>%
  ggplot(aes(y=fct_rev(bap), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.21)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion parmi les répondant·es ITA", y="",
       title="Branche d'activité professionnelle (BAP) des ITA", 
       caption=sprintf("Lecture : 20%% des répondant·es ingénieur·es, technicien·nes et administratif·ves relèvent de la BAP « Sciences du vivant ».
Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : ITA affilié·es à une unité du CNRS (n=%i)", nrow(drop_na(climat, bap))))

```


# Position vis-à-vis de l’environnement et de la recherche

## Activités humaines et changement climatique
```{r echo=FALSE}
climat$acthum3 <- fct_collapse(climat$acthum2,
                               "Oui, elles jouent un grand rôle\nou en sont l'unique cause"=c("Oui, elles en sont l'unique cause", 
                                 "Oui, elles jouent un grand rôle"))
pal <- RColorBrewer::brewer.pal(6, "RdYlGn")
ggplot(drop_na(climat, acthum3),
       aes(y=fct_rev(acthum3), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", pal[c(1, 2, 4, 6)])) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 1)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Les activités humaines sont-elles la cause du changement climatique\n(hausse des températures depuis une centaine d'années) ?") +
  source_champ(nrow(drop_na(climat, acthum3)),
               "Lecture : pour 95,1% des répondant·es, les activités humaines jouent un grand rôle ou sont l'unique cause du changement climatique.")
```

## Préoccupation par rapport au changement climatique
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, preoccupe),
       aes(y=fct_relevel(preoccupe, "Sans opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#74add1", "#fee090", "#fdae61", "#f46d43", "#d73027")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.42)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Dans quelle mesure êtes-vous préoccupé·e par le changement climatique ?") +
  source_champ(nrow(drop_na(climat, preoccupe)),
               "Lecture : 31,7% des répondant·es sont extrêmement préoccupé·es par le changement climatique.")

```

## Evolution des préoccupations 
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, pluspreoccupe),
       aes(y=fct_relevel(fct_rev(pluspreoccupe), "Sans opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#74add1", "#e5f5f9", "#dfc27d", "#f46d43", "#d73027")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.46)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  theme(plot.title=element_text(size=10), plot.subtitle=element_text(size=8)) +
  labs(x="Proportion des répondant·es", y="",
       title="Êtes-vous plus ou moins préoccupé·e par le changement climatique qu'il y a 5 ans ?") +
  source_champ(nrow(drop_na(climat, pluspreoccupe)),
               "Lecture : 44,6% des répondant·es sont beaucoup plus préocupé·es par le changement climatique qu'il y a cinq ans.")
```

## Changement des pratiques
```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, chgtpratique),
       aes(y=fct_relevel(fct_rev(chgtpratique), "Sans opinion"), x=..prop.., group=1)) +
  geom_bar(fill=c("light grey", "#d7191c", "#fdae61", "#a6d96a", "#1a9641")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.60)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  theme(plot.title=element_text(size=10),
        plot.subtitle=element_text(size=8)) +
  labs(x="Proportion des répondant·es", y="",
       title="Pensez−vous que l'urgence climatique exige des changements profonds\ndans la pratique de nos métiers ?") +
  source_champ(nrow(drop_na(climat, chgtpratique)),
               "Lecture: 47% des répondant·es pensent que l'urgence climatique exige des changements profonds dans la pratique de nos métiers.")
```

# Pratiques des personnes et des laboratoires


## Actions mises en œuvre dans les laboratoires/unités

```{r echo=FALSE}
dat <- rbind(data.frame(variable="Vous pouvez trier vos déchets", valeur=climat$labopratiques.tri),
             data.frame(variable="Vous êtes encouragé·e à prendre le train\nplutôt que l'avion", valeur=climat$labopratiques.train),
              data.frame(variable="Il existe une charte/un groupe de travail/un·e responsable\npour réduire l'empreinte écologique des activités de recherche", valeur=climat$labopratiques.charte),
              data.frame(variable="Des mesures ont été mises en œuvre pour limiter\n l'impact environnemental des pots/buffets", valeur=climat$labomesures.pots)) %>%
     mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c(
            "Oui", "Non, mais la question a été abordée", 
            "Non concerné·e", "Je ne sais pas", "Non")))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "grey70", "grey40", "#a6d96a", "#1a9641")) +
     scale_y_continuous(labels=scales::percent_format(),
                        sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
     coord_flip() + labs(fill="") +
     theme(legend.position="bottom") +
     guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
     labs(y="Proportion des répondant·es", x="",
          title="Actions mises en œuvre 
dans les laboratoires/unités de recherche :") +
     source_champ(max(table(drop_na(dat)$variable)), "Lecture : 77% des répondant·es déclarent pouvoir trier leurs déchets dans leur laboratoire.")
```

## Matériel informatique utilisé

```{r echo=FALSE, message=FALSE}
informatique<- climat %>% 
  select(starts_with("ordis.")) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = "_") 

informatique<-aggregate( informatique[,2:8], informatique[,1], FUN = sum, na.rm=T)

infoTot<-data.frame(cbind(informatique[, 1], rowSums(informatique[, 2:8])))

infoTot$NbOrdi<-as.numeric(infoTot$X2)

infoTot<- infoTot %>% mutate(prop=NbOrdi/NbOrdi[which(X1=="nb")])

infoTot<-infoTot[1:2,]

infoTot$X1[infoTot$X1=="5ans"]<-"Matériel de moins de 5 ans"
infoTot$X1[infoTot$X1=="indisp"]<-"Matériel jugé indispensable"


ggplot(infoTot,  aes(x=prop, y=X1 )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 0.78)) +
  labs(y="", x="Part de l'ensemble des ordinateurs et tablettes",
       title="") +
  source_champ(sum(rowSums(!is.na(select(climat, starts_with("ordis.")))) > 0), "75% des ordinateurs et des tablettes sont jugé·es indispensables par leur utilisateur·ice.")

```



```{r echo=FALSE, message=FALSE, fig.height=5}

informatique2 <- informatique %>% 
  pivot_longer(ordis.partage:ordis.tabletteperso,
               names_to = "TypeOrdi",
               values_to= "NombreOrdi") %>%
  mutate(prop=NombreOrdi/sum(NombreOrdi))

informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.partage"]<-"Ordinateurs partagés au laboratoire"
informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.fixepro"]<-"Ordinateurs fixes individuels achetés\navec des financements professionnels"
informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.fixeperso"]<-"Ordinateurs fixes individuels achetés\npar vous"
informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.portablepro"]<-"Ordinateurs portables individuels achetés\navec des financements professionnels"
informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.portableperso"]<-"Ordinateurs portables individuels achetés\npar vous"
informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.tablettepro"]<-"Tablettes achetées\navec des financements professionnels"
informatique2$TypeOrdi[informatique2$TypeOrdi=="ordis.tabletteperso"]<-"Tablettes achetées\npar vous"


informatique2$set[informatique2$set=="nb"]<-"Tous ordinateurs/tablettes"
informatique2$set[informatique2$set=="5ans"]<-"De moins de 5 ans"
informatique2$set[informatique2$set=="indisp"]<-"Jugé·es indispensables"

ggplot(informatique2,  aes(x=prop, y=fct_reorder(TypeOrdi, prop), fill= set )) +
  geom_col(position = "dodge") +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=0.1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3) +
  coord_cartesian(xlim=c(0, 0.16)) +
  guides(fill=guide_legend(reverse=TRUE, nrow=3)) +
  theme(legend.position="bottom") +
  labs(y="", x="Part de l'ensemble des ordinateurs et tablettes", fill="",
       title="Type de matériel utilisé, selon son âge et son caractère indispensable") +
  source_champ(sum(rowSums(!is.na(select(climat, starts_with("ordis.")))) > 0),
  "Lecture : Sur 100 tablettes et ordinateurs utilisé·es professionnellement, 14,3 sont des ordinateurs partagés,
11,6 sont des ordinateurs partagés qui ont moins de 5 ans, et 5,8 sont des ordinateurs partagés jugés indispensables.")

```

## Raisons du dernier changement d'ordinateur

```{r echo=FALSE}
aumoinsunecochee <- rowSums(select(climat, starts_with("chgtordi.")) == "Oui", na.rm=TRUE) > 0

chgtOrdi<- climat %>% 
  select(starts_with("chgtordi.")) %>%
  pivot_longer(everything(),
               names_to = c(".value", "TypeRaisonChgtOrdi"),
               names_sep = "(\\.)") %>% group_by(TypeRaisonChgtOrdi) %>%
  count(chgtordi) %>% filter(chgtordi=="Oui") %>%
  mutate(prop=n/sum(aumoinsunecochee))

chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="fctplusbien"]<-"Il ne fonctionnait plus très bien"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="puissant"]<-"Il n’était pas assez puissant"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="jamais"]<-"Je n’ai jamais changé mon ordinateur à usage professionnel"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="misajour"]<-"Il ne pouvait plus être mis à jour"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="propose"]<-"On me l’a proposé/j’en avais l’opportunité"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="contrat"]<-"J’ai eu un nouveau contrat de travail"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="fctplus"]<-"Il ne fonctionnait plus du tout"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="mieux"]<-"J’en voulais un mieux (meilleure autonomie, écran, etc.)"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="autre"]<-"Autre"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="oblige"]<-"On m’y a obligé"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="vole"]<-"On me l’a volé, je l’ai perdu"
chgtOrdi$TypeRaisonChgtOrdi[chgtOrdi$TypeRaisonChgtOrdi=="neuf"]<-"J’en voulais un neuf"

ggplot(chgtOrdi,  aes(x=prop, y=fct_reorder(TypeRaisonChgtOrdi, prop) )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3) +
  coord_cartesian(xlim=c(0, 0.32)) +
  labs(y="", x="Proportion des répondant·es",
       title="Raison(s) pour lesquelles les répondant·es ont changé 
leur ordinateur") +
  source_champ(sum(aumoinsunecochee), "30% des répondant·es ont changé leur dernier ordinateur car il ne fonctionnait plus très bien.")

```

## Achats avec un reliquat de budget

```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, reliquat.ordi),
       aes(y=fct_relevel(reliquat.ordi), x=..prop.., group=1)) +
  geom_bar(fill=c("#74add1", "#d7191c", "light grey"  )) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.45)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Au cours des 5 dernières années vous est-il arrivé pour terminer
 un reliquat de budget d'acheter un ordinateur/écran/tablette 
 alors que ce n'était pas vraiment indispensable ?") + 
  source_champ(nrow(drop_na(climat, reliquat.ordi)),
               "Lecture : 20% des répondant·es ont utilisé un reliquat de budget pour acheter du matériel non indispensable.")
```
 
## Vols pour les conférences : évolution des émissions de GES 

```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(9, "RdYlBu")
ggplot(drop_na(climat, solevolges.conf),
       aes(y=fct_rev(solevolges.conf), x=..prop.., group=1)) +
  geom_bar(fill=c("black", "light grey", "#1a9641","#a6d96a","#f8f375" ,"#fdae61","#d7191c")) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.3)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Au cours des 5 dernières années (hors confinement), diriez vous que vos émissions\nde gaz à effet de serre liées à vos vols en avion pour les conférences/réunions ont...") +
  source_champ(nrow(drop_na(climat, solevolges.conf)),
               "Lecture : 6% des répondant·es ont fortement augmenté leurs émissions liées à des vols pour les conférences/réunions depuis 5 ans.")
```

# Transports à des fins professionnelles

## Heures de vol en avion en 2019 (hors trajets domicile-travail)

```{r echo=FALSE}
climat$volshTot<-climat$volsh
levels(climat$volshTot)<-c("0h", levels(climat$volshTot))
climat$volshTot[climat$volsnb==0]<-"0h"

ggplot(drop_na(climat, volshTot),
       aes(y=fct_rev(volshTot), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="",
       title="Heures de vol en avion dans le cadre professionnel en 2019") +
  source_champ(nrow(drop_na(climat, volshTot)),
               "Lecture : 75% des répondant·es n'ont pas volé au cours des cinq dernières années, et 10% ont volé mais moins de 10h.")
```

## Heures de vol en avion en 2017 et 2018 pour celles et ceux n'ayant pas pris l'avion en 2019

```{r echo=FALSE}
ggplot(drop_na(climat, vols2ans),
       aes(y=fct_rev(vols2ans), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.7)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion parmi les répondant·es n'ayant pas pris l'avion en 2019",
       y="",
       title="Avez-vous pris l'avion dans le cadre professionnel en 2017 et 2018 ?", 
       caption=sprintf("Lecture: 66%% des répondant·es n'ayant pas pris l'avion en 2019 ne l'ont pas non plus pris en 2017 et 2018.
Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : personnels affiliés à une unité du CNRS n'ayant pas pris l'avion en 2019 (n=%i)", nrow(drop_na(climat, vols2ans))))
```

## Temps travaillé sur place lors d'un déplacement professionnel en avion

```{r echo=FALSE, message=FALSE}
#En fonction du nombre de déplacements pro
#On tient compte du nombre d'aller retour pour avoir le nombre de séjours réels (volsnb)
#Pour tout demi aller-retour, il faut aussi compter un séjour entier (ceiling)
DFNbJourTravailles<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsjours", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>%
  count(volsjours, wt=ceiling(volsnb)) %>%
  drop_na(volsjours) %>%
  mutate(prop=n/sum(n))

ggplot(DFNbJourTravailles,  aes(x=prop, y=volsjours )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 0.62)) +
  labs(y="", x="Part des déplacements en avion",
       title="Part des déplacements professionnels en avion,
selon le temps travaillé sur place") +
  source_champ(sum(climat$volsremplis, na.rm=TRUE),
               "Lecture : sur 100 vols professionnels, 5 correspondaient à un séjour de plus d'un mois.")

#En fonction de la distance totale parcourue
DFNbJourTravailles<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsjours", 1:5), paste0("volsdist", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>% group_by(volsjours) %>%
  summarize(DistTotale=sum(volsdist*volsnb, na.rm=T)) %>%
  drop_na(volsjours) %>%
  mutate(prop=DistTotale/sum(DistTotale))

ggplot(DFNbJourTravailles,  aes(x=prop, y=volsjours )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 0.53)) +
  labs(y="", x="Part du total des distances parcourues en avion",
       title="Part du total des distances parcourues en avion,
       selon le temps travaillé sur place") +
  source_champ(sum(climat$volsremplis, na.rm=TRUE),
               "Lecture : sur 100 km parcourus en avion, 12 km l'ont été pour des séjours de plus d'un mois.")
```

## Motif principal des déplacements professionnels en avion

```{r echo=FALSE, message=FALSE}
#En fonction du nombre de déplacements pro
#On tient compte du nombre d'aller retour pour avoir le nombre de séjours réels (volsnb)
#Pour tout demi aller-retour, il faut aussi compter un séjour entier (ceiling)
DFDistAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsmotif", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>%
  count(volsmotif, wt=ceiling(volsnb)) %>%
  drop_na(volsmotif) %>%
  mutate(prop=n/sum(n))

ggplot(DFDistAvion,  aes(x=prop, y=fct_reorder(volsmotif, prop) )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 0.42)) +
  labs(y="",
       x="Part des déplacements en avion",
       title="Motif principal pour les déplacements professionnels\neffectués en avion") +
  source_champ(sum(climat$volsremplis, na.rm=TRUE),
               "Lecture : sur 100 vols professionnels, 40 avaient pour motif une présentation dans une conférence.")

#En fonction de la distance totale parcourue
DFDistAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsmotif", 1:5), paste0("volsdist", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>% group_by(volsmotif) %>%
  summarize(DistTotale=sum(volsdist*volsnb, na.rm=T)) %>%
  drop_na(volsmotif) %>%
  mutate(prop=DistTotale/sum(DistTotale))

ggplot(DFDistAvion,  aes(x=prop, y=fct_reorder(volsmotif, prop) )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 0.45)) +
  labs(y="", x="Part du total des distances parcourues en avion",
       title="Part du total des distances parcourues en avion\nselon le motif principal du déplacement professionnel") +
  source_champ(sum(climat$volsremplis, na.rm=TRUE),
               "Lecture : sur 100 km parcourus en avion, 43 km l'ont été pour une présentation dans une conférence.")

```

## Distance parcourue en avion selon le motif du déplacement professionnel

```{r echo=FALSE, message=FALSE}
DFDistMoyAvion<- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsmotif", 1:5), paste0("volsdist", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>% group_by(volsmotif) %>%
  summarize(DistMoy=mean(volsdist, na.rm=T)) %>%
  drop_na(volsmotif)

ggplot(DFDistMoyAvion,  aes(x=DistMoy, y=fct_reorder(volsmotif, DistMoy) )) +
  geom_col() +
    labs(y="",
         title="Distance parcourue en avion selon le motif principal\ndu déplacement professionnel",
       x="Distance moyenne parcourue en avion (en km)") +
  source_champ(sum(climat$volsremplis, na.rm=TRUE),
               "Lecture : en moyenne, les vols liés au terrain ou au recueil de données font 10 400 km (aller-retour).")

```


## Répartition des émissions de GES en avion selon le temps nécessaire pour faire le même déplacement en train

Les temps de trajet en train sont obtenus à partir des horaires de la SNCF (ou des entreprises équivalentes pour l'étranger). Les émissions de gaz à effet de serre sont calculées à partir de la distance orthodromique + 95 km, selon la méthode [GES 1point5](https://labos1point5.org/ges-1point5).

```{r echo=FALSE, message=FALSE}
DFDistAvion <- climat %>% 
  select(paste0("volsnb", 1:5), paste0("volsges", 1:5), paste0("volstrain3h", 1:5), paste0("volstrain6h", 1:5)) %>%
  pivot_longer(everything(),
               names_to = c(".value", "set"),
               names_sep = -1) %>%
  mutate(volstrain=if_else(volstrain3h == "Oui" | volstrain3h == "Parfois",
                           "Moins de 3h de train",
                           if_else(volstrain6h == "Oui" | volstrain6h == "Parfois",
                                   "Entre 3h et 6h de train",
                                   "Plus de 6h de train ou impossible"))) %>%
  group_by(volstrain) %>%
  summarize(DistTotale=sum(volsges*volsnb, na.rm=T)) %>%
  drop_na(volstrain) %>%
  mutate(prop=DistTotale/sum(DistTotale))

ggplot(DFDistAvion,  aes(x=prop, y=fct_reorder(volstrain, prop) )) +
  geom_col(fill=c("#fc8d59", "#e34a33", "#b30000")) +
  scale_x_continuous(labels=scales::percent_format()) +
  geom_text(aes(label=scales::percent(prop, accuracy=0.1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 1)) +
  labs(y="", x=bquote("Part du total des émissions en" ~CO[2] *"e"),
       title="Répartition des émissions de gaz à effet de serre des déplacements professionnels\nen avion selon le temps nécessaire pour faire ce même déplacement en train") +
  source_champ(sum(climat$volsremplis, na.rm=TRUE),
               "0,2% des émissions de gaz à effet de serre des vols correspondent à des déplacements\nqui auraient pu être réalisés en moins de 3h de train.")

```


## Raisons d'avoir pris l'avion alors que le trajet en train prend moins de 6h

```{r echo=FALSE}
# != "Non" pour inclure les diverses réponses à Autre
aumoinsunecochee <- rowSums(select(climat, starts_with("aviontrainraisons.")) != "Non", na.rm=TRUE) > 0
raisons <- climat %>%
  select(starts_with("aviontrainraisons.")) %>%
  mutate(aviontrainraisons.other=if_else(is.na(aviontrainraisons.other),
                                         NA_character_, "Oui")) %>%
  pivot_longer(everything(),
               names_to = c(".value", "TypeRaison"),
               names_sep = "(\\.)") %>%
  group_by(TypeRaison) %>%
  count(aviontrainraisons) %>%
  filter(aviontrainraisons == "Oui") %>%
  mutate(prop=n/sum(aumoinsunecochee))
raisons$TypeRaison <- fct_recode(raisons$TypeRaison,
                                 "L'avion est plus rapide"="rapide",
                                 "L'avion permet d'éviter une nuit sur place"="nuit",
                                 "L'avion est moins cher"="cher",
                                 "L'avion est plus pratique"="pratique",
                                 "Des règles administratives m'incitent à prendre l’avion"="admin",
                                 "J'aime prendre l'avion"="aime",
                                 "Je ne me suis pas posé la question"="paspose",
                                 "Cela me permet de cumuler des miles"="miles",
                                 "Autre"="other")
ggplot(raisons, aes(x=prop, y=fct_reorder(TypeRaison, prop))) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3) +
  coord_cartesian(xlim=c(0, 0.68)) +
  labs(y="", x="Proportion parmi les répondant·es concerné·es",
       title="Raison(s) pour lesquelles les répondant·es ont pris l'avion\nalors que le même trajet en train prenait moins de 6h") +
  source_champ(sum(aumoinsunecochee),
               "Lecture : pour 66% des répondant·es ayant pris l'avion pour un trajet qui prend moins de 6h en train,\nle fait que l'avion soit plus rapide est une des raisons de l'avoir choisi.")
```

## Avoir pris le train plutôt que l'avion alors que le trajet est plus long

```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(6, "RdYlGn")
ggplot(drop_na(climat, trainavion),
       aes(y=fct_rev(trainavion), x=..prop.., group=1)) +
  geom_bar(fill=pal[c(1, 3, 4, 6)]) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count",position=position_dodge(.9),
            hjust=-0.2, size=3)+
  coord_cartesian(xlim=c(0, 0.42)) +
  labs(x="Proportion des répondant·es", y="", 
       title ="Au cours des 5 dernières années, avez-vous, pour des raisons environnementales,\npris le train plutôt que l’avion dans le cadre professionnel\nalors que le trajet était plus long ?") +
  source_champ(nrow(drop_na(climat, trainavion)))
```

## Avoir renoncé à un déplacement à l'étranger pour des raisons environnementales


```{r echo=FALSE}
pal <- RColorBrewer::brewer.pal(6, "RdYlGn")
ggplot(drop_na(climat, renoncedep.env),
       aes(y=fct_rev(renoncedep.env), x=..prop.., group=1)) +
  geom_bar(fill=pal[c(1, 4, 6)]) +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.78)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="", 
       title = "En 2019, avez-vous renoncé à un ou plusieurs déplacements
professionnels à l’étranger pour des considérations environnementales ?") +
  source_champ(nrow(drop_na(climat, renoncedep.env)))
```

## Travail à domicile

```{r echo=FALSE}
ggplot(drop_na(climat, joursdomicile),
       aes(y=fct_rev(joursdomicile), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.5)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="", 
       title = "En temps normal (avant le confinement), combien de jours en moyenne 
travaillez-vous uniquement de chez vous ? Ne tenez pas compte des éventuels 
jours travaillés le week-end.") +
  source_champ(nrow(drop_na(climat, joursdomicile)))
```

## Déplacements domicile-travail

```{r echo=FALSE, message=FALSE}
TpsTransportDomT<- climat %>% 
  select(tpsdomtrav.urbainMin, tpsdomtrav.tgvMin, tpsdomtrav.trainMin, tpsdomtrav.voitMin, tpsdomtrav.covoitMin, tpsdomtrav.motoMin, tpsdomtrav.veloMin, tpsdomtrav.marcheMin ) %>%
  pivot_longer(everything(),
               names_to = c(".value", "TypeTransport"),
               names_sep = 11) %>% group_by(TypeTransport) %>%
  summarize(Tpstotal=sum(tpsdomtrav., na.rm=T)) %>%
  mutate(prop=Tpstotal/sum(Tpstotal))

TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="voitMin"]<-"Seul·e dans une voiture"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="urbainMin"]<-"Bus, métro, tramway, RER"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="marcheMin"]<-"Marche"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="veloMin"]<-"Vélo ou trottinette"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="covoitMin"]<-"À plusieurs dans une voiture"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="trainMin"]<-"Autres trains"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="tgvMin"]<-"TGV"
TpsTransportDomT$TypeTransport[TpsTransportDomT$TypeTransport=="motoMin"]<-"Moto, scooter"

ggplot(TpsTransportDomT,  aes(x=prop, y=fct_reorder(TypeTransport, prop) )) +
  geom_col() +
  scale_x_continuous(labels=scales::percent_format()) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3) +
  coord_cartesian(xlim=c(0, 0.37)) +
  labs(y="",
       x="Proportion du temps total passé dans les déplacements domicile-travail",
       title="Part du temps total passé dans les déplacements domicile-travail,
par l'ensemble des répondant·es, par mode de transport") +
  source_champ(sum(climat$tpsdomtravrempli))
```

## Raisons de ne pas covoiturer

```{r echo=FALSE}
aumoinsunecochee <- rowSums(!is.na(select(climat, starts_with("covoitpqpas")))) > 0

Covoit<- climat %>% 
  select(covoitpqpas.flex,  covoitpqpas.atypique,  covoitpqpas.orga,  covoitpqpas.ecole,  covoitpqpas.personne,  covoitpqpas.fiabilite,  covoitpqpas.entente,  covoitpqpas.court, covoitpqpas.trouver) %>%
  pivot_longer(everything(),
               names_to = c(".value", "RaisonsPasCovoit"),
               names_sep = 12) %>% group_by(RaisonsPasCovoit) %>%
  count(covoitpqpas.) %>% filter(covoitpqpas.=="Oui") %>%
   mutate(prop=n/1216)

Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="flex"]<-"Je tiens à la flexibilité de mes horaires"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="atypique"]<-"J’ai des horaires trop atypiques ou trop irréguliers"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="personne"]<-"Je n’ai trouvé personne\navec un trajet et des horaires proches"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="ecole"]<-"Je dois déposer les enfants à l’école"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="court"]<-"Le trajet est trop court"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="orga"]<-"Cela demande trop d’organisation"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="fiabilite"]<-"J’ai peur du manque de fiabilité des autres"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="trouver"]<-"Je ne sais pas comment trouver\nun·e covoitureur·se"
Covoit$RaisonsPasCovoit[Covoit$RaisonsPasCovoit=="entente"]<-"Je crains de covoiturer avec quelqu’un\navec qui je ne m’entends pas"


ggplot(Covoit,  aes(x=prop, y=fct_reorder(RaisonsPasCovoit, prop) )) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  geom_text(aes(label=scales::percent(prop, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3) +
  coord_cartesian(xlim=c(0, 0.47)) +
  labs(y="", x="Proportion parmi les répondant·es autosolistes",
       title="Pour les trajets que vous réalisez seul·e dans votre voiture,\npourquoi ne faites-vous pas du covoiturage ?",
       caption=sprintf("Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : personnels affiliés à une unité du CNRS prenant la voiture seul·es\npour leurs trajets domicile-travail (n=%i)", sum(aumoinsunecochee)))

```

# La visioconférence

Les répondant·es ont été interrogé·es sur la visioconférence et l'audioconférence. Par souci de concision, le terme visioconférence regroupe ci-dessous la visioconférence et l'audioconférence.

## Usages auxquels la visioconférence est adaptée

```{r echo=FALSE, message=FALSE}
dat <- rbind(data.frame(variable="Une réunion de travail\nde 3 à 5 personnes",
                        valeur=climat$visiousages.reunion5),
             data.frame(variable="Une réunion de travail\nà 15 personnes", 
                        valeur=climat$visiousages.reunion15),
             data.frame(variable="Un oral de jury", 
                        valeur=climat$visiousages.jury),
             data.frame(variable="Une présentation en séminaire", 
                        valeur=climat$visiousages.seminaire),
             data.frame(variable="Une conférence ou un congrès\nà plusieurs présentations",
                        valeur=climat$visiousages.conf))%>%
  mutate(variable=factor(variable, levels=unique(variable)),
         valeur=fct_relevel(valeur, c(
           "Très adaptée", 
           "Plutôt adaptée", 
           "Sans opinion", 
           "Plutôt pas adaptée", 
           "Pas adaptée du tout",
           "Je n'ai jamais testé")),
         valeur=fct_recode(valeur,
                           "Très adaptées"="Très adaptée",
                           "Plutôt adaptées"="Plutôt adaptée",
                           "Plutôt pas adaptées"="Plutôt pas adaptée",
                           "Pas adaptées du tout"="Pas adaptée du tout"))

dat$variable <- factor(dat$variable,
  levels = c(
    "Un oral de jury", "Une conférence ou un congrès\nà plusieurs présentations",
    "Une réunion de travail\nà 15 personnes", "Une présentation en séminaire",
    "Une réunion de travail\nde 3 à 5 personnes"
  )
)

drop_na(dat) %>%
  group_by(variable) %>%
  summarize(valeur=sum(valeur == "Je n'ai jamais testé")/n()) %>%
  ggplot(aes(y=variable, x=valeur)) +
  geom_col() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.29)) +
  theme(legend.position="bottom") +
  guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
  geom_text(aes(label=scales::percent(valeur, accuracy=1, decimal.mark=",")),
            position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(y="", x="Proportion des répondant·es",
       title="Part des répondants n'ayant jamais testé chaque usage de la visioconférence") +
  source_champ(max(table(drop_na(dat)$variable)))

drop_na(dat[dat$valeur != "Je n'ai jamais testé",]) %>%
  ggplot(aes(x=variable)) +
  geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
  scale_fill_manual(values=c("#d7191c","#fdae61", "light grey", "#a6d96a", "#1a9641"))+
  scale_y_continuous(labels=scales::percent_format(),
                     sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
  coord_flip() +
  theme(legend.position="bottom") +
  guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
  labs(y="Proportion parmi les répondant·es ayant déjà testé", x="", fill="",
       title="Actuellement, pour quels usages la visioconférence ou l'audioconférence 
       vous semblent-elles adaptées ?",
       caption=sprintf("Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020\nChamp : personnels affiliés à une unité du CNRS ayant déjà testé chaque usage de la visioconférence (n=%i)",  max(table(drop_na(dat[dat$valeur != "Je n'ai jamais testé",])$variable))))

```


## Raisons de privilégier la visioconférence 

```{r echo=FALSE, fig.height=5}

dat <- rbind(data.frame(variable="Gagner du temps",
                        valeur=climat$visioprivilegiee.temps),
             data.frame(variable="Limiter la fatigue due au déplacement", 
                        valeur=climat$visioprivilegiee.fatigue),
             data.frame(variable="Limiter les frais de mission", 
                        valeur=climat$visioprivilegiee.frais),
             data.frame(variable="Mieux concilier vos contraintes familiales\net votre activité professionnelle", 
                        valeur=climat$visioprivilegiee.famille),
             data.frame(variable="Limiter vos émissions\nde gaz à effet de serre", 
                        valeur=climat$visioprivilegiee.emissions),
             data.frame(variable="Pouvoir faire autre chose\nen même temps que la réunion", 
                        valeur=climat$visioprivilegiee.autrechose),
             data.frame(variable="Réunir facilement de nombreuses personnes\ntrès éloignées géographiquement", 
                        valeur=climat$visioprivilegiee.reunir))%>%
  mutate(variable=factor(variable, levels=unique(variable)),
         valeur=fct_relevel(valeur, c(
           "Oui, beaucoup", 
           "Oui, un peu", 
           "Sans opinion", 
           "Non, pas vraiment", 
           "Non, pas du tout")))

drop_na(dat) %>%
  ggplot(aes(x=variable)) +
  geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
  scale_fill_manual(values=c("#d7191c","#fdae61", "light grey", "#a6d96a", "#1a9641"))+
  scale_y_continuous(labels=scales::percent_format(),
                     sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
  coord_flip() +
  theme(legend.position="bottom") +
  guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
  labs(y="Proportion des répondant·es", x="", fill="",
       title="Imaginons une réunion d’une journée, située à 2h de votre domicile
en voiture. Les raisons suivantes pourraient-elles vous pousser à
privilégier la visioconférence ou l’audioconférence à un déplacement ?") +
  source_champ(max(table(drop_na(dat)$variable)))

```


## Usage pré-confinement de la visioconférence

```{r echo=FALSE}

ggplot(drop_na(climat, visioavtconf),
       aes(y=fct_rev(visioavtconf), x=..prop.., group=1)) +
  geom_bar() +
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.44)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=0.1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="", title="Avant le confinement quel était votre usage habituel de la visioconférence
ou de l’audioconférence dans le cadre professionnel ?") +
  source_champ(nrow(drop_na(climat, visioavtconf)))
```

## Evolution de l'opinion sur la visioconférence depuis le confinement

```{r echo=FALSE}
ggplot(drop_na(climat, visioapresconf),
       aes(y=fct_rev(visioapresconf), x=..prop.., group=1)) +
  geom_bar()+
  geom_bar(fill=rev(c("#d73027", "#f46d43","#dfc27d", "#e5f5f9", "#74add1","light grey")))+
  scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
  coord_cartesian(xlim=c(0, 0.39)) +
  geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
  labs(x="Proportion des répondant·es", y="", title="Depuis le confinement, votre expérience vous a-t-elle rendu·e plus favorable
ou moins favorable à la visioconférence ou l’audioconférence ?") +
  source_champ(nrow(drop_na(climat, visioapresconf)))

```


# Réduction des émissions de GES dans la recherche : les solutions concrètes

## Objectifs nationaux d'ici à 2030 et place du secteur de la recherche 

```{r echo=FALSE}
climat$solreducrech2 <- fct_recode(climat$solreducrech,
  "Montrer l'exemple\n(réduire ses émissions de plus d'un tiers)" = "La recherche publique doit montrer l'exemple en matière de diminution des émissions de gaz à effet de serre en les rédui",
  "Réduire ses émissions d'un tiers environ" = "La recherche publique doit réduire ses émissions de gaz à effet de serre d'un tiers environ",
  "Bénéficier d'un statut dérogatoire\n(réduire ses émissions de moins d'un tiers)" = "En raison de son rôle, la recherche publique peut bénéficier d'un statut dérogatoire, c'est-à-dire fournir des efforts m"
)
ggplot(drop_na(climat, solreducrech2),
       aes(y=fct_rev(solreducrech2), x=..prop.., group=1)) +
    geom_bar(fill=c("#d7191c", "#a6d96a", "#1a9641")) +
    scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
    coord_cartesian(xlim=c(0, 0.5)) +
    geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
    labs(x="Proportion des répondant·es", y="",
         title="La France s’est engagée à réduire d’un tiers ses émissions\nde gaz à effet de serre d'ici à 2030.\nDans ce cadre, pensez-vous que la recherche publique doit :") +
  source_champ(nrow(drop_na(climat, solreducrech2)))
```

## Réductions individuelles des émissions de GES dans le cadre professionnel d'ici à 2030

```{r echo=FALSE, fig.height=6}
dat <- rbind(data.frame(variable="Les expériences et observations\nscientifiques", valeur=climat$solreducperso.exp),
             data.frame(variable="Les déplacements pour missions de terrain,\nd'observation ou de collecte de données", valeur=climat$solreducperso.donnees),
             data.frame(variable="Les déplacements domicile-travail\nen voiture, moto, scooter ou avion", valeur=climat$solreducperso.domicile),
             data.frame(variable="L'équipement en postes informatiques\net sa fréquence de renouvellement", valeur=climat$solreducperso.info),
             data.frame(variable="Les vols en avion\npour les conférences, réunions, congrès", valeur=climat$solreducperso.conf)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("Non, car elles sont déjà très basses", "Oui, d'au moins un tiers", "Oui, mais de moins d'un tiers", "Sans opinion", "Non")))

drop_na(dat) %>%
    filter(valeur != "Non concerné·e") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#66bd63", "#1a9641", "#3690c0")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
    labs(y="Proportion des répondant·es", x="",
         title="Êtes-vous prêt·e à réduire vos émissions de gaz à effet de serre\nd’ici à 2030 dans les domaines suivants ?") +
  source_champ(max(table(filter(drop_na(dat), valeur != "Non concerné·e")$variable)),
               "Note : la proportion de personnes concernées varie selon la question")
```

## Réductions individuelles des émissions de GES des dispositifs expérimentaux d'ici à 2030

```{r echo=FALSE, fig.height=6}
dat <- rbind(data.frame(variable="En utilisant moins d'équipements\ndans les dispositifs expérimentaux", valeur=climat$solreducmateriel.moins),
             data.frame(variable="En l'utilisant moins fréquemment\nou moins intensivement", valeur=climat$solreducmateriel.util),
             data.frame(variable="En utilisant ou en développant\ndes dispositifs plus simples (low tech)", valeur=climat$solreducmateriel.lowtech),
             data.frame(variable="En renouvelant le matériel\nmoins fréquemment", valeur=climat$solreducmateriel.renouv)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("Non, car elles sont déjà très basses", "Oui, d'au moins un tiers", "Oui, mais de moins d'un tiers", "Sans opinion", "Non")))

drop_na(dat) %>%
    filter(valeur != "Non concerné·e") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#66bd63", "#1a9641", "#3690c0")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
    labs(y="Proportion parmi les répondant·es utilisant un dispositif expérimental", x="",
         title="Êtes-vous prêt·e à réduire d'ici à 2030 les émissions de gaz à effet de serre\nliées à la fabrication et au fonctionnement du matériel destiné\nà vos expériences et observations scientifiques, par les moyens suivants ?",
         caption=sprintf("Note : la proportion de personnes concernées varie selon la question
Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020
Champ : personnels permanents affiliés à une unité du CNRS, utilisant un dispositif expérimental (n=%i)", max(table(filter(drop_na(dat), valeur != "Non concerné·e")$variable))))
```


## Risques liés à la réduction des émissions de GES des dispositifs expérimentaux

```{r echo=FALSE, fig.height=6, fig.width=7.5}
dat <- rbind(data.frame(variable="Vous faire prendre du retard\npar rapport aux équipes concurrentes", valeur=climat$solrisqreducmateriel.retard),
             data.frame(variable="Diminuer la qualité de vos travaux", valeur=climat$solrisqreducmateriel.qual),
             data.frame(variable="Réduire votre accès aux financements", valeur=climat$solrisqreducmateriel.fin),
             data.frame(variable="Réduire votre nombre de publications", valeur=climat$solrisqreducmateriel.publi),
             data.frame(variable="Vous imposer un changement\nde thèmes de recherche", valeur=climat$solrisqreducmateriel.themes)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("C'est probable et c'est un problème", "Sans opinion", "C'est probable mais ce n'est pas un problème", "C'est peu probable")))

drop_na(dat) %>%
    filter(valeur != "Non concerné·e") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=valeur), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion parmi les répondant·es utilisant un dispositif expérimental", x="",
         title="Quels seraient les risques liés à une politique de réduction des émissions\nde gaz à effet de serre liées à la fabrication et au fonctionnement\ndu matériel destiné aux expériences et aux observations scientifiques ?",
         caption=sprintf("Note : la proportion de personnes concernées varie selon la question
Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020
Champ : personnels affiliés à une unité du CNRS, utilisant un dispositif expérimental (n=%i)", max(table(filter(drop_na(dat), valeur != "Non concerné·e")$variable))))
```

## Risques liés à la réduction des vols

```{r echo=FALSE, fig.height=6, fig.width=7.5}
dat <- rbind(data.frame(variable="Réduire certains avantages\nque vous apporte votre métier", valeur=climat$solrisqreducavion.avantages),
             data.frame(variable="Réduire votre accès aux financements", valeur=climat$solrisqreducavion.fin),
             data.frame(variable="Diminuer la qualité de vos travaux", valeur=climat$solrisqreducavion.qual),
             data.frame(variable="Diminuer la diffusion de vos travaux", valeur=climat$solrisqreducavion.diffusion),
             data.frame(variable="Isoler la recherche française\ndu reste du monde", valeur=climat$solrisqreducavion.isoler),
             data.frame(variable="Accroître la bureaucratie", valeur=climat$solrisqreducavion.bureaucratie),
             data.frame(variable="Vous gêner pour l’accès à certains terrains\nou la collecte/production de certaines données", valeur=climat$solrisqreducavion.donnees),
             data.frame(variable="Gêner l’insertion des jeunes chercheurs", valeur=climat$solrisqreducavion.insertion)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("C'est probable et c'est un problème", "Sans opinion", "C'est probable mais ce n'est pas un problème", "C'est peu probable")))

drop_na(dat) %>%
    filter(valeur != "Non concerné·e") %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=valeur), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion des répondant·es", x="",
         title="Quels seraient les risques liés à la mise en place d'une politique\nde réduction des vols professionnels en avion dans la recherche ?") +
    source_champ(max(table(filter(drop_na(dat), valeur != "Non concerné·e")$variable)),
                 "Note : la proportion de personnes concernées varie selon la question")
```

## Solutions institutionnelles

```{r echo=FALSE, fig.height=7, fig.width=7.5}
dat <- rbind(data.frame(variable="Ajouter les émissions carbone parmi les principaux\ncritères de sélection des projets à financer", valeur=climat$solinstit.selection),
             data.frame(variable="Imposer une limite au nombre de vols\nen avion par personne", valeur=climat$solinstit.limitevols),
             data.frame(variable="Financer des initiatives de compensation carbone", valeur=climat$solinstit.compensation),
             data.frame(variable="Diminuer le poids des conférences et présentations\nà l’étranger dans les évaluations de carrière", valeur=climat$solinstit.conf),
             data.frame(variable="Dresser et diffuser régulièrement\ndes bilans carbone détaillés", valeur=climat$solinstit.bilanges),
             data.frame(variable="Proscrire les vols en avion lorsque\nle trajet en train prend moins de 6 heures", valeur=climat$solinstit.vols6h),
             data.frame(variable="Ne pas renouveler le matériel informatique qui fonctionne\navant un minimum de 5 ans d’ancienneté", valeur=climat$solinstit.info),
             data.frame(variable="Financer le train même lorsque c'est plus cher\nou allonge la durée de la mission", valeur=climat$solinstit.train),
             data.frame(variable="Lors de l'organisation d’événements, favoriser les prestataires\nproposant des menus locaux ou végétariens", valeur=climat$solinstit.vege),
             data.frame(variable="Lors du renouvellement des équipements, privilégier ceux\nqui consomment moins d'énergie même s'ils sont plus coûteux", valeur=climat$solinstit.equip)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("C'est prioritaire", "C'est secondaire", "Sans opinion", "Il ne faut pas le mettre en œuvre")))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=2, byrow=TRUE)) +
    labs(y="Proportion des répondant·es", x="",
         title="Quelles actions les institutions et laboratoires\nde recherche devraient-ils mettre en œuvre\npour réduire leurs émissions de gaz à effet de serre ?") +
  source_champ(max(table(drop_na(dat)$variable)))
```

## Covoiturage

```{r echo=FALSE}
ggplot(drop_na(climat, solcovoit),
       aes(y=fct_rev(solcovoit), x=..prop.., group=1)) +
    geom_bar(fill=c("#d7191c", "#fdae61", "#a6d96a", "#1a9641")) +
    scale_x_continuous(labels=function(x) scales::percent(x, 1)) +
    coord_cartesian(xlim=c(0, 0.35)) +
    geom_text(aes(label=scales::percent(..prop.., accuracy=1, decimal.mark=",")),
            stat="count", position=position_dodge(.9),
            hjust=-0.2, size=3) +
    labs(x="Proportion parmi les répondant·es prenant la voiture", y="",
         title="Si le covoiturage était organisé à l'échelle de votre laboratoire ou de votre site,\nseriez-vous prêt·e à y recourir pour vos trajets domicile-travail ?",
         caption=sprintf("Source : Enquête « Les personnels de la recherche face au changement climatique », Labos 1point5, 2020
Champ : personnels affiliés à une unité du CNRS prenant la voiture pour leurs déplacements domicile-travail (n=%i)",  nrow(drop_na(climat, solcovoit))))
```

# Avis par rapport à l’écologie en général

## Opinions sur l'écologie

```{r echo=FALSE, fig.height=5}
dat <- rbind(data.frame(variable="Il ne sert à rien que je fasse des efforts pour l'environnement\nsi les autres ne font pas de même", valeur=climat$opinionecolo.efforts),
data.frame(variable="La plupart des problèmes environnementaux peuvent être résolus\npar le développement de technologies plus performantes",
                        valeur=climat$opinionecolo.techno),
             data.frame(variable="La décroissance est nécessaire\npour faire face aux enjeux environnementaux", valeur=climat$opinionecolo.decroissance),
             data.frame(variable="Je suis d’accord pour que des contraintes réglementaires\nsoient mises en place pour protéger l'environnement,\nmême si cela limite mon confort", valeur=climat$opinionecolo.contraintes),
             data.frame(variable="Protéger l'environnement est plus important\nque protéger la croissance économique", valeur=climat$opinionecolo.proteger),
             data.frame(variable="Ce type de catastrophe pourrait provoquer\nun effondrement de nos sociétés*", valeur=climat$opinionecolo.effondrement2),
             data.frame(variable="Si les choses continuent au rythme actuel,\nnous allons bientôt vivre une catastrophe écologique majeure", valeur=climat$opinionecolo.cata)) %>%
    mutate(variable=factor(variable, levels=unique(variable)),
           valeur=fct_relevel(valeur, c("Tout à fait d'accord", "Plutôt d'accord", "Sans opinion", "Plutôt pas d'accord", "Pas du tout d'accord")))

drop_na(dat) %>%
    ggplot(aes(x=variable)) +
    geom_bar(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#d7191c", "#fdae61", "light grey", "#a6d96a", "#1a9641")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse = TRUE, nrow=3, byrow=TRUE)) +
    labs(y="Proportion des répondant·es", x="") +
    source_champ(max(table(drop_na(dat)$variable)),
                  "* Les personnes ayant répondu négativement à la question précédente sont classées en « Pas du tout d'accord ».")
```


# Quiz sur les émissions de GES

Une réponse est considérée comme correcte si elle est à une modalité d'écart maximum de la vraie réponse.

```{r echo=FALSE}
dat <- rbind(data.frame(variable="Parcourir 50 km en voiture pour aller et revenir\ndu travail pendant un an (soit environ 12 000 km)", valeur=climat$quizfacteurs.voiture2, reponse="3 000 kg"),
             data.frame(variable="Fabriquer un ordinateur portable neuf", valeur=climat$quizfacteurs.ordi2, reponse="250 kg"),
             data.frame(variable="Imprimer une thèse de 200 pages\nen 10 exemplaires, recto-verso", valeur=climat$quizfacteurs.these2, reponse="5 kg"),
             data.frame(variable="Faire un aller-retour Paris – New York en avion\n(soit environ 12 000 km)", valeur=climat$quizfacteurs.avion2, reponse="1 000 kg"),
             data.frame(variable="Produire un steak de bœuf de 150 g", valeur=climat$quizfacteurs.steak2, reponse="5 kg"),
             data.frame(variable="Faire un aller-retour Paris-Marseille en TGV\n(soit 1600 km)", valeur=climat$quizfacteurs.TGV2, reponse="5 kg"),
             data.frame(variable="Faire 3 heures de visioconférence\navec votre ordinateur (pour une personne)", valeur=climat$quizfacteurs.visio2, reponse="100 g")) %>%
    mutate(variable=factor(variable, levels=unique(variable)))

drop_na(dat) %>%
    count(variable, valeur) %>%
    mutate(reponse=ifelse(valeur == "Correct",
                          dat$reponse[match(variable, dat$variable)],
                          "")) %>%
    ggplot(aes(x=variable, y=n)) +
    geom_col(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#e41a1c", "#4daf4a", "#377eb8")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse=TRUE)) +
    geom_text(aes(label=reponse), position=position_fill(vjust=0.5), size=3) +
    labs(y="Proportion des répondant·es", x="",
         title="Estimations des émissions de gaz à effet de serre") +
    source_champ(max(table(drop_na(dat)$variable)))
```

Dans cette variante, une réponse n'est correcte que si la bonne modalité a été exactement choisie. Elle est considérée comme une légère sous- ou surestimation en cas d'écart d'une catégorie.

```{r echo=FALSE, fig.height=5}
dat <- rbind(data.frame(variable="Parcourir 50 km en voiture pour aller et revenir\ndu travail pendant un an (soit environ 12 000 km)", valeur=climat$quizfacteurs.voiture3, reponse="3 000 kg"),
             data.frame(variable="Fabriquer un ordinateur portable neuf", valeur=climat$quizfacteurs.ordi3, reponse="250 kg"),
             data.frame(variable="Imprimer une thèse de 200 pages\nen 10 exemplaires, recto-verso", valeur=climat$quizfacteurs.these3, reponse="5 kg"),
             data.frame(variable="Faire un aller-retour Paris – New York en avion\n(soit environ 12 000 km)", valeur=climat$quizfacteurs.avion3, reponse="1 000 kg"),
             data.frame(variable="Produire un steak de bœuf de 150 g", valeur=climat$quizfacteurs.steak3, reponse="5 kg"),
             data.frame(variable="Faire un aller-retour Paris-Marseille en TGV\n(soit 1600 km)", valeur=climat$quizfacteurs.TGV3, reponse="5 kg"),
             data.frame(variable="Faire 3 heures de visioconférence\navec votre ordinateur (pour une personne)", valeur=climat$quizfacteurs.visio3, reponse="100 g")) %>%
    mutate(variable=factor(variable, levels=unique(variable)))

drop_na(dat) %>%
    count(variable, valeur) %>%
    mutate(reponse=ifelse(valeur == "Correct",
                          dat$reponse[match(variable, dat$variable)],
                          "")) %>%
    ggplot(aes(x=variable, y=n)) +
    geom_col(aes(fill=fct_rev(valeur)), position="fill") +
    scale_fill_manual(values=c("#ca0020", "#f4a582", "#4daf4a", "#92c5de", "#0571b0")) +
    scale_y_continuous(labels=scales::percent_format(),
                       sec.axis=sec_axis(~ 1-., labels=scales::percent_format())) +
    coord_flip() + labs(fill="") +
    theme(legend.position="bottom") +
    guides(fill=guide_legend(reverse=TRUE, nrow=2, byrow=TRUE)) +
    geom_text(aes(label=reponse), position=position_fill(vjust=0.5), size=3) +
    labs(y="Proportion des répondant·es", x="",
         title="Estimations des émissions de gaz à effet de serre") +
    source_champ(max(table(drop_na(dat)$variable)))
```